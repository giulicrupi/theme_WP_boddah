(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){window.app={initComponents:require('./modules/init-components'),svg:require('./modules/svg'),get:require('./modules/get'),pageChange:require('./modules/page-change'),loader:require('./modules/loader'),loadScript:require('./modules/load-script'),popup:require('./modules/popup'),components:{home:require('./components/home'),about:require('./components/about'),partnes:require('./components/partnes'),buildings:require('./components/buildings'),building:require('./components/building'),loader:require('./components/loader'),modal:require('./components/modal/modal'),webdoor:require('./components/webdoor'),map:require('./components/map'),button:require('./components/button'),header:require('./components/header'),footer:require('./components/footer'),pages:require('./components/pages'),menu:require('./components/menu'),numbers:require('./components/numbers'),status:require('./components/status'),differentials:require('./components/differentials'),videoFrame:require('./components/video-frame'),video:require('./components/video'),news:require('./components/news'),newsSlide:require('./components/news-slide'),new:require('./components/new'),contact:require('./components/contact'),contactMap:require('./components/contactMap'),form:require('./components/form'),instagram:require('./components/instagram'),videoGallery:require('./components/v-gallery'),},templates:{modal:require('../nunj/components/modal/modal.nunj'),alert:require('../nunj/components/modal/modal-alert.nunj'),},init:function(){app.initComponents();app.svg();app.pageChange();},};$(app.init);},{"../nunj/components/modal/modal-alert.nunj":36,"../nunj/components/modal/modal.nunj":37,"./components/about":2,"./components/building":3,"./components/buildings":4,"./components/button":5,"./components/contact":6,"./components/contactMap":7,"./components/differentials":8,"./components/footer":9,"./components/form":10,"./components/header":11,"./components/home":12,"./components/instagram":13,"./components/loader":14,"./components/map":15,"./components/menu":16,"./components/modal/modal":17,"./components/new":18,"./components/news":20,"./components/news-slide":19,"./components/numbers":21,"./components/pages":22,"./components/partnes":23,"./components/status":24,"./components/v-gallery":25,"./components/video":27,"./components/video-frame":26,"./components/webdoor":28,"./modules/get":29,"./modules/init-components":30,"./modules/load-script":31,"./modules/loader":32,"./modules/page-change":33,"./modules/popup":34,"./modules/svg":35}],2:[function(require,module,exports){var $main=$('.main-content');var $cont=$('.about');var $webdoor=$cont.find('.webdoor');function init(){$cont.on('enter',motionIn);$cont.on('leave',motionOut);$main.data('motion-out-time',2000);}
function motionIn(e,oldPage){if($(document).find('main').attr('data-page')=='home'){if($(window).scrollTop()>10){$('.header').css('margin-top','0px');}else{$('.header').css('margin-top','39px');}}else{$('.header').css('margin-top','0px');}
$webdoor.find('.w-background').addClass('motion-in');setTimeout(function(){$webdoor.find('.button').addClass('motion-in');$webdoor.find('h1').addClass('motion-in');setTimeout(function(){$webdoor.find('.breadcrumb').addClass('motion-in');$webdoor.find('.scroll').addClass('motion-in');setTimeout(function(){$cont.find('.content').addClass('motion-in');$cont.find('.numbers').addClass('motion-in');},500);},500);},500);}
function motionOut(e,newPage){$('.header').css('margin-top','0px');setTimeout(function(){$cont.find('.content').removeClass('motion-in');$cont.find('.numbers').removeClass('motion-in');setTimeout(function(){$webdoor.find('.w-background').removeClass('motion-in');$webdoor.find('.button').removeClass('motion-in');$webdoor.find('h1').removeClass('motion-in');$webdoor.find('.breadcrumb').removeClass('motion-in');$webdoor.find('.scroll').removeClass('motion-in');},500);},1000);}
module.exports={init:init,condition:$cont,args:arguments,}},{}],3:[function(require,module,exports){var $main=$('.main-content');var $cont=$('.building');var $gallery=$cont.find('.gallery');var $slides=$gallery.find('.slides:not(.over)');var $slidesOver=$gallery.find('.slides.over');var $webdoor=$cont.find('.webdoor');var $selectMap=$cont.find('.select-map').find('.d-item');var $selectMapBt=$cont.find('.select-map');var $selectTeam=$cont.find('.select-team').find('.d-item');var $selectTeamBt=$cont.find('.select-team');var $btVideo=$cont.find('.bt-video');var _windowWidth=$(window).width();var $blueprint=$cont.find('.g-map').find('.slides').find('.images');var $ImagesTeam=$cont.find('.g-team').find('.slides').find('.slide');var _url=location.pathname.split('/');function init(){$cont.on('enter',motionIn);$cont.on('leave',motionOut);$main.data('motion-out-time',2000);$slides.each(function(i,e){if($(e).parent().data('type')=='carrossel'){initSlick(e);}else if($(e).parent().data('type')=='team'){if(_windowWidth>760){initSlickTeam(e);}}else{initFlick(e);}});$slidesOver.each(function(i,e){initFlickOver(e);});app.components.header.changeTagGoogle(_url[_url.length-1]);$btVideo.on('click',function(){var _codeYT=$(this).data('video');app.components.video.openVideo(_codeYT);});selectTeam();selectMap();}
function selectMap(){$cont.find('.select-map .label').text($cont.find('.select-map  .d-item.active a').text());$selectMapBt.on('click',function(){if($(this).hasClass('active')){$(this).removeClass('active');}else{$(this).addClass('active');}});$selectMap.on('click',function(){var _data=$(this).find('a').data('filter');$selectMap.removeClass('active');$(this).addClass('active');$cont.find('.select-map .label').text($(this).find('a').text());if($selectMapBt.hasClass('active')){$(this).removeClass('active');}
$cont.find('.g-map').find('.slides').flickity('destroy');$cont.find('.g-map').find('.a-prev').off('click');$cont.find('.g-map').find('.a-next').off('click');$cont.find('.g-map').find('.slides').find('.images').remove();$blueprint.each(function(){if(_data=='all'){$cont.find('.g-map').find('.slides').append($(this));}
if($(this).data('filter')==_data){$cont.find('.g-map').find('.slides').append($(this));}});initFlick($cont.find('.g-map').find('.slides'));});}
function selectTeam(){$selectTeamBt.on('click',function(){if($(this).hasClass('active')){$(this).removeClass('active');}else{$(this).addClass('active');}});$selectTeam.on('click',function(){var _data=$(this).find('a').data('filter');$selectTeam.removeClass('active');$(this).addClass('active');if($selectTeamBt.hasClass('active')){$(this).removeClass('active');}
$cont.find('.select-team .label').text($(this).find('a').text());if(_windowWidth>760){$cont.find('.g-team').find('.slides').slick('unslick');}
$cont.find('.g-team').find('.slides').find('.slide').remove();$ImagesTeam.each(function(){if(_data=='all'){$cont.find('.g-team').find('.slides').append($(this));}
if($(this).data('filter')==_data){$cont.find('.g-team').find('.slides').append($(this));}});if(_windowWidth>760){initSlickTeam($cont.find('.g-team').find('.slides'));}});}
function initSlick(e){$(e).slick({arrows:false,dots:false,infinite:true,pauseOnHover:false,variableWidth:true,slidesToShow:3,slidesToScroll:1,speed:600,cssEase:'cubic-bezier(.55,.085,0,.99)',responsive:[{breakpoint:1025,settings:{slidesToShow:1,slidesToScroll:1}}]});if(_windowWidth>1025){if($($gallery).find('.slide-arrowDesactiver').length<4){$($gallery).find('.arrows').addClass('hideArrow');}}else if(_windowWidth>320){if($($gallery).find('.slide-arrowDesactiver').length<2){$($gallery).find('.arrows').addClass('hideArrow');}}
$(e).on('afterChange',function(e,slick,current){});$(e).parent().find('.a-next').on('click',function(){$(e).slick('slickNext');console.log('clicou, prÃ³ximo');});$(e).parent().find('.a-prev').on('click',function(){$(e).slick('slickPrev');console.log('clicou, voltando');});$(e).slick('slickGoTo',0);}
function initSlickTeam(e){$(e).slick({arrows:false,dots:true,infinite:false,pauseOnHover:false,variableWidth:true,speed:600,cssEase:'cubic-bezier(.55,.085,0,.99)',});$(e).on('afterChange',function(e,slick,current){});$(e).parent().find('.a-next').on('click',function(){$(e).slick('slickNext');});$(e).parent().find('.a-prev').on('click',function(){$(e).slick('slickPrev');});$(e).slick('slickGoTo',0);}
function initFlick(e){$(e).flickity({contain:true,pageDots:false,wrapAround:true,selectedAttraction:0.01,friction:0.15,prevNextButtons:false,draggable:false,fullscreen:true,});$(e).parent().find('.a-prev').on('click',function(){$(e).flickity('previous');$(e).parent().find('.over').flickity('previous');});$(e).parent().find('.a-next').on('click',function(){$(e).flickity('next');$(e).parent().find('.over').flickity('next');});$(e).flickity('selectCell',0);$(e).parent().find('.btZoom').on('click',function(){if($(this).hasClass('active')){$(this).removeClass('active');$(this).parent().find('.slides:not(.over)').removeClass('zoom');$(this).parent().removeClass('zoom');$(e).flickity('exitFullscreen');}else{$(this).addClass('active');$(this).parent().find('.slides:not(.over)').addClass('zoom');$(this).parent().addClass('zoom');$(e).flickity('viewFullscreen');}});}
function initFlickOver(e){$(e).flickity({contain:true,pageDots:false,wrapAround:true,selectedAttraction:0.01,friction:0.15,prevNextButtons:false,draggable:false});$(e).flickity('selectCell',1);}
function motionIn(e,oldPage){if($(document).find('main').attr('data-page')=='home'){if($(window).scrollTop()>10){$('.header').css('margin-top','0px');}else{$('.header').css('margin-top','39px');}}else{$('.header').css('margin-top','0px');}
$webdoor.find('.w-background').addClass('motion-in');setTimeout(function(){$webdoor.find('.button').addClass('motion-in');$webdoor.find('h1').addClass('motion-in');$webdoor.find('.logo').addClass('motion-in');setTimeout(function(){$webdoor.find('.breadcrumb').addClass('motion-in');$webdoor.find('.scroll').addClass('motion-in');setTimeout(function(){$cont.find('.content').addClass('motion-in');},500);},500);},500);}
function motionOut(e,newPage){$('.header').css('margin-top','0px');setTimeout(function(){$webdoor.find('.w-background').removeClass('motion-in');$webdoor.find('.button').removeClass('motion-in');$webdoor.find('.logo').removeClass('motion-in');$webdoor.find('h1').removeClass('motion-in');$webdoor.find('.scroll').removeClass('motion-in');$webdoor.find('.breadcrumb').removeClass('motion-in');$cont.find('.content').removeClass('motion-in');},500);}
module.exports={init:init,condition:$cont,args:arguments,}},{}],4:[function(require,module,exports){var $main=$('.main-content');var $cont=$('.buildings');var $gallery=$cont.find('.gallery');var $slides=$gallery.find('.slides');var $webdoor=$cont.find('.webdoor');function init(){$cont.on('enter',motionIn);$cont.on('leave',motionOut);$main.data('motion-out-time',2000);$slides.each(function(i,e){initFlick(e);});}
function initFlick(e){$(e).flickity({contain:true,pageDots:false,wrapAround:true,selectedAttraction:0.01,friction:0.15,prevNextButtons:false,});$($cont).find('.item').each(function(){if($(this).find('.images').length<2){$(this).find('.arrows').addClass('hideArrow');}});$(e).parent().find('.a-prev').on('click',function(){$(e).flickity('previous');});$(e).parent().find('.a-next').on('click',function(){$(e).flickity('next');});$(e).flickity('selectCell',0);if($(e).hasClass('over')){$(e).flickity('selectCell',1);}}
function motionIn(e,oldPage){if($(document).find('main').attr('data-page')=='home'){if($(window).scrollTop()>10){$('.header').css('margin-top','0px');}else{$('.header').css('margin-top','39px');}}else{$('.header').css('margin-top','0px');}
setTimeout(function(){$webdoor.find('.button').addClass('motion-in');$webdoor.find('h1').addClass('motion-in');$webdoor.find('.filter').addClass('motion-in');$webdoor.find('.paragraph').addClass('motion-in');setTimeout(function(){$webdoor.find('.breadcrumb').addClass('motion-in');$webdoor.find('.scroll').addClass('motion-in');$cont.find('.mosaic').addClass('motion-in');},500);},500);}
function motionOut(e,newPage){$('.header').css('margin-top','0px');setTimeout(function(){$webdoor.find('.button').removeClass('motion-in');$webdoor.find('h1').removeClass('motion-in');$webdoor.find('.filter').removeClass('motion-in');$webdoor.find('.scroll').removeClass('motion-in');$webdoor.find('.breadcrumb').removeClass('motion-in');$webdoor.find('.paragraph').removeClass('motion-in');$cont.find('.mosaic').removeClass('motion-in');},500);}
module.exports={init:init,condition:$cont,args:arguments,}},{}],5:[function(require,module,exports){var $cont=$('.button');function init(){$cont.on('click',function(){var _codeYT=$(this).data('video');if(_codeYT){app.components.video.openVideo(_codeYT);}});}
module.exports={init:init,condition:$cont,args:arguments,}},{}],6:[function(require,module,exports){var $main=$('.main-content');var $cont=$('.contact');var $webdoor=$cont.find('.webdoor');function init(){$cont.on('enter',motionIn);$cont.on('leave',motionOut);$main.data('motion-out-time',2000);}
function motionIn(e,oldPage){if($(document).find('main').attr('data-page')=='home'){if($(window).scrollTop()>10){$('.header').css('margin-top','0px');}else{$('.header').css('margin-top','39px');}}else{$('.header').css('margin-top','0px');}
$webdoor.find('.w-background').addClass('motion-in');setTimeout(function(){$webdoor.find('.button').addClass('motion-in');$webdoor.find('h1').addClass('motion-in');setTimeout(function(){$webdoor.find('.breadcrumb').addClass('motion-in');$webdoor.find('.scroll').addClass('motion-in');setTimeout(function(){$cont.find('.content').addClass('motion-in');},500);},500);},500);}
function motionOut(e,newPage){$('.header').css('margin-top','0px');setTimeout(function(){$cont.find('.content').removeClass('motion-in');setTimeout(function(){$webdoor.find('.w-background').removeClass('motion-in');$webdoor.find('.button').removeClass('motion-in');$webdoor.find('h1').removeClass('motion-in');$webdoor.find('.breadcrumb').removeClass('motion-in');$webdoor.find('.scroll').removeClass('motion-in');},500);},1000);}
module.exports={init:init,condition:$cont,args:arguments,}},{}],7:[function(require,module,exports){var $cont=$('.contactMap');var $map=$cont.find('.l-map');function init(){window.initGmaps=function(){buildMap();}
if($map.is(':visible')){if(window.google&&window.google.maps)initGmaps();else app.loadScript('//maps.googleapis.com/maps/api/js?key='+(app.get('gkey')||'AIzaSyCZDAmjlUz5FY4bNaQlagvRZg2ysi92VA4')+'&callback=initGmaps');}}
function buildMap(){var lat=-23.5619869;var lng=-46.6608625;var coords=new google.maps.LatLng(lat,lng);var mapOptions={scaleControl:false,draggable:true,scrollwheel:false,panControl:true,mapTypeId:google.maps.MapTypeId.ROADMAP,zoom:15,center:new google.maps.LatLng(lat,lng),styles:[{"featureType":"water","elementType":"geometry","stylers":[{"color":"#e9e9e9"},{"lightness":17}]},{"featureType":"landscape","elementType":"geometry","stylers":[{"color":"#f5f5f5"},{"lightness":20}]},{"featureType":"road.highway","elementType":"geometry.fill","stylers":[{"color":"#ffffff"},{"lightness":17}]},{"featureType":"road.highway","elementType":"geometry.stroke","stylers":[{"color":"#ffffff"},{"lightness":29},{"weight":0.2}]},{"featureType":"road.arterial","elementType":"geometry","stylers":[{"color":"#ffffff"},{"lightness":18}]},{"featureType":"road.local","elementType":"geometry","stylers":[{"color":"#ffffff"},{"lightness":16}]},{"featureType":"poi","elementType":"geometry","stylers":[{"color":"#f5f5f5"},{"lightness":21}]},{"featureType":"poi.park","elementType":"geometry","stylers":[{"color":"#dedede"},{"lightness":21}]},{"elementType":"labels.text.stroke","stylers":[{"visibility":"on"},{"color":"#ffffff"},{"lightness":16}]},{"elementType":"labels.text.fill","stylers":[{"saturation":36},{"color":"#333333"},{"lightness":40}]},{"elementType":"labels.icon","stylers":[{"visibility":"off"}]},{"featureType":"transit","elementType":"geometry","stylers":[{"color":"#f2f2f2"},{"lightness":19}]},{"featureType":"administrative","elementType":"geometry.fill","stylers":[{"color":"#fefefe"},{"lightness":20}]},{"featureType":"administrative","elementType":"geometry.stroke","stylers":[{"color":"#fefefe"},{"lightness":17},{"weight":1.2}]}],};var contentString='<div class="i-container">'+
'<div class="l-infos">'+
'<div class="l-image" style="background-image: url();"></div>'+
'<div class="title">SKR</div>'+
'<div class="sub-title">Alameda Min. Rocha Azevedo, 456<br>Cerqueira CÃ©sar, SÃ£o Paulo - SP 01410-000</div>'+
'</div>'+
'</div>';var infowindow=new google.maps.InfoWindow({content:contentString});map=new google.maps.Map($map[0],mapOptions);var marker=new google.maps.Marker({position:coords,map:map,icon:{url:"public/frontend/img/ico-pinSKR.svg",scaledSize:new google.maps.Size(50,50),},});infowindow.open(map,marker);}
module.exports={init:init,condition:$cont,args:arguments,}},{}],8:[function(require,module,exports){var $cont=$('.differentials');var $gallery=$cont.find('.gallery');var $slides=$gallery.find('.slides');function init(){$slides.each(function(i,e){initFlick(e);});}
function initFlick(e){$(e).flickity({contain:true,pageDots:false,wrapAround:true,selectedAttraction:0.01,friction:0.15,prevNextButtons:false,});$(e).parent().find('.a-prev').on('click',function(){$(e).flickity('previous');});$(e).parent().find('.a-next').on('click',function(){$(e).flickity('next');});$(e).flickity('selectCell',0);if($(e).hasClass('over')){$(e).flickity('selectCell',1);}}
module.exports={init:init,condition:$cont,args:arguments,}},{}],9:[function(require,module,exports){var $cont=$('.footer');var $btUp=$cont.find('.scrollUp');var $form=$cont.find('form');var $msgNews=$cont.find('.message-error');var $FooterYear=$cont.find('.foot-year');var $MenuYear=$('.menu').find('.copyright').find('span');function init(){$btUp.on('click',function(){$('body,html').animate({'scrollTop':0},1000);});$form.on('submit enterKey',sendNews);$form.find('button').on('click',sendNews);$cont.find('input').keydown(function(){var email=$(this).val();if(validateEmail(email)){$cont.find('button').removeClass("disabled");}else{$cont.find('button').addClass("disabled");}});getYear();}
function sendNews(event){event.preventDefault();var url_news=GLOBAL_URL+'frontend/Contact/newsletter/';var inputNews=$form.find('input');var email=inputNews.val();if($('#newsletter-accept').is(':checked')==false){$msgNews.text("Por favor, aceitar os termos!");$msgNews.addClass('show');return false;}
if(validateEmail(email)){$.post(url_news,{email:email},function(data){if(data.result==false){$msgNews.text(data.message);$form.find('input').each(function(){$(this).val('');});$form.addClass('sucess');setTimeout(function(){$form.removeClass('sucess');$msgNews.text(" ");$cont.find('button').removeClass("disabled");},4000);}else{$msgNews.text(data.message);}},'json');}else{$msgNews.text("Email invÃ¡lido");$msgNews.addClass('show');}}
function validateEmail(email){var re=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return re.test(String(email).toLowerCase());}
function getYear(){var setYear=new Date;var _year=setYear.getFullYear();$FooterYear.html('Â®SKR '+_year);$MenuYear.html('Â®SKR '+_year);}
module.exports={init:init,condition:$cont,args:arguments,}},{}],10:[function(require,module,exports){var $cont=$('.form');function init(){$cont.closest('.f-contact').each(validateContact);$cont.closest('.f-sellLand').each(validadeSellLand);$cont.closest('.f-partners').each(validadePartner);$cont.closest('.f-workUs').each(validateWork);$cont.closest('.f-building').each(validateBuilding);$cont.closest('.f-visit').each(validateVisit);$cont.closest('.f-conduct').each(validateConduct);$cont.find('.file').on('change',function(){var _url=$(this).val();$cont.find('.url').text(_url);});$cont.find('[name="cep"]').blur(function(){var $input=$(this);var $form=$(this).closest('form');var CEP=$input.val().replace('-','');if(CEP.length<8)return;$.get('https://api.postmon.com.br/v1/cep/'+CEP).success(function(data){$form.find('[name="address"]').val(data.logradouro);$form.find('[name="address"]').removeClass('error');$form.find('[name="address"]').next().css('display','none');$form.find('[name="neighborhood"]').val(data.bairro);$form.find('[name="neighborhood"]').removeClass('error');$form.find('[name="neighborhood"]').next().css('display','none');$form.find('[name="city"]').val(data.cidade);$form.find('[name="city"]').removeClass('error');$form.find('[name="city"]').next().css('display','none');$form.find('[name="state_code"]').val(data.estado);$form.find('[name="state_code"]').removeClass('error');$form.find('[name="state_code"]').next().css('display','none');}).error(function(data){$form.validate().showErrors({cep:'CEP invÃ¡lido.'});});});$("form").submit(function(e){e.preventDefault();})
setMask();}
function setMask(){$cont.find('[name="cpf"]').mask('000.000.000-00');$cont.find('[name="cnpj"]').mask('00.000.000/0000-00');$cont.find('[name="document"]').mask('000.000.000-00');$cont.find('[name="cep"]').mask('00000-000');$cont.find('[name="phone"]').mask('(00) 999 999 999');$cont.find('[name="cellphone"]').mask('(00) 999 999 999');}
function validateContact(){var _toogle=false;$(this).find('form').validate({submitHandler:function(form){$(form).find('button').addClass('desactive');$(form).find('button').html('<span>AGUARDE...</span>');if(!_toogle){var datastring=$(form).serialize();var nome=$(form).find('input[name=name]').val();var email=$(form).find('input[name=email]').val();var telefone=$(form).find('input[name=phone]').val();var mensagem=$(form).find('textarea[name=message]').val();var id_crm="";$.ajax({type:"POST",url:GLOBAL_URL+"frontend/Contact/send_contact/",data:datastring,dataType:"json",success:function(data){console.log('ajax success');if(data.result){app.components.modal.alert({text:data.message,title:':)'});setTimeout(function(){location.reload();},3000);}else{app.components.modal.alert({text:data.message,title:' '});$(form).find('button').removeClass('desactive');$(form).find('button').html('<span>ENVIAR</span>');_toogle=false;}}});_toogle=true;}},ignore:'.ignore',errorElement:'span',rules:{name:'required',email:{required:true,email:true},phone:{required:true,minlength:15,},subject:{required:true,},message:'required',},messages:{name:"Por favor digite seu nome.",email:{required:"Por favor digite seu email.",email:"Por favor digite um email vÃ¡lido."},phone:{required:"Por favor digite seu Telefone.",minlength:"NÃºmero invÃ¡lido."},subject:{required:'Por favor selecione o seu assunto.',},message:"Por favor digite sua mensagem.",},highlight:function(element,errorClass,validClass){$(element).parent().addClass(errorClass);},unhighlight:function(element,errorClass,validClass){$(element).parent().removeClass(errorClass);},});}
function validadePartner(){var _toogle=false;$(this).find('form').validate({submitHandler:function(form){$(form).find('button').addClass('desactive');$(form).find('button').html('<span>AGUARDE...</span>');if(!_toogle){var datastring=$(form).serialize();console.log('ajax send');$.ajax({type:"POST",url:GLOBAL_URL+"frontend/Contact/send_parceria/",data:datastring,dataType:"json",success:function(data){console.log('ajax success');if(data.result){app.components.modal.alert({text:data.message,title:':)'});setTimeout(function(){location.reload();},3000);}else{app.components.modal.alert({text:data.message,title:' '});$(form).find('button').removeClass('desactive');$(form).find('button').html('<span>ENVIAR</span>');_toogle=false;}}});_toogle=true;}},ignore:'.ignore',errorElement:'span',rules:{name:'required',creci:'required',email:{required:true,email:true},phone:{required:true,minlength:15,},subject:{required:true,},cnpj:{required:function(){return(($("#tipo_parceiro").val()=="imobiliaria")||($("#tipo_parceiro").val()=="autonomo_imobiliaria"))},},cpf:{required:function(){return($("#tipo_parceiro").val()=="autonomo")},},message:'required',},messages:{name:"Por favor digite seu nome.",creci:"Por favor digite seu CRECI.",email:{required:"Por favor digite seu email.",email:"Por favor digite um email vÃ¡lido."},phone:{required:"Por favor digite seu Telefone.",minlength:"NÃºmero invÃ¡lido."},subject:{required:'Por favor selecione o seu assunto.',},cpf:{required:'Por favor selecione o seu CPF.',},cnpj:{required:'Por favor selecione o CNPJ.',},message:"Por favor digite sua mensagem.",},highlight:function(element,errorClass,validClass){$(element).parent().addClass(errorClass);},unhighlight:function(element,errorClass,validClass){$(element).parent().removeClass(errorClass);},});}
function validateConduct(){var _toogle=false;$(this).find('form').validate({submitHandler:function(form){$(form).find('button').addClass('desactive');$(form).find('button').html('<span>AGUARDE...</span>');if(!_toogle){var datastring=$(form).serialize();console.log('ajax send');$.ajax({type:"POST",url:GLOBAL_URL+"frontend/Contact/send_desvio/",data:datastring,dataType:"json",success:function(data){console.log('ajax success');if(data.result){app.components.modal.alert({text:data.message,title:':)'});setTimeout(function(){location.reload();},3000);}else{app.components.modal.alert({text:data.message,title:' '});$(form).find('button').removeClass('desactive');$(form).find('button').html('<span>ENVIAR</span>');_toogle=false;}}});_toogle=true;}},ignore:'.ignore',errorElement:'span',rules:{name:'required',email:{required:true,email:true},phone:{required:true,minlength:15,},subject:'required',message:'required',},messages:{name:"Por favor digite seu nome.",email:{required:"Por favor digite seu email.",email:"Por favor digite um email vÃ¡lido."},phone:{required:"Por favor digite seu Telefone.",minlength:"NÃºmero invÃ¡lido."},subject:"Por favor digite o seu assunto.",message:"Por favor digite sua mensagem.",},highlight:function(element,errorClass,validClass){$(element).parent().addClass(errorClass);},unhighlight:function(element,errorClass,validClass){$(element).parent().removeClass(errorClass);},});}
function validateBuilding(){var _toogle=false;$(this).find('form').validate({submitHandler:function(form){$(form).find('button').addClass('desactive');$(form).find('button').html('<span>AGUARDE...</span>');if(!_toogle){var datastring=$(form).serialize();var nome=$(form).find('input[name=name]').val();var email=$(form).find('input[name=email]').val();var telefone=$(form).find('input[name=phone]').val();var mensagem=$(form).find('textarea[name=message]').val();var id_crm=$(form).data('id_crm');console.log(id_crm+', '+true+', '+nome+', '+email+', '+''+', '+telefone+', '+mensagem);$.ajax({type:"POST",url:GLOBAL_URL+"frontend/Contact/send_contact/",data:datastring,dataType:"json",success:function(data){if(data.result){app.components.modal.alert({text:data.message,title:':)'});setTimeout(function(){location.reload();},3000);}else{app.components.modal.alert({text:data.message,title:' '});$(form).find('button').removeClass('desactive');$(form).find('button').html('<span>ENVIAR</span>');_toogle=false;}}});_toogle=true;}},ignore:'.ignore',errorElement:'span',rules:{name:'required',email:{required:true,email:true},phone:{required:true,minlength:15,},subject:'required',message:'required',},messages:{name:"Por favor digite seu nome.",email:{required:"Por favor digite seu email.",email:"Por favor digite um email vÃ¡lido."},phone:{required:"Por favor digite seu Telefone.",minlength:"NÃºmero invÃ¡lido."},subject:"Por favor digite o seu assunto.",message:"Por favor digite sua mensagem.",},highlight:function(element,errorClass,validClass){$(element).parent().addClass(errorClass);},unhighlight:function(element,errorClass,validClass){$(element).parent().removeClass(errorClass);},});}
function validateVisit(){var _toogle=false;$(this).find('form').validate({submitHandler:function(form){$(form).find('button').addClass('desactive');$(form).find('button').html('<span>AGUARDE...</span>');if(!_toogle){var datastring=$(form).serialize();var nome=$(form).find('input[name=name]').val();var email=$(form).find('input[name=email]').val();var telefone=$(form).find('input[name=phone]').val();var mensagem=$(form).find('textarea[name=message]').val();if($(form).find('#building').data('id_crm')!=undefined){var id_crm=$(form).find('#building').data('id_crm');}else{var id_crm=$(form).find(':selected').data('id_crm');}
console.log(id_crm+', '+true+', '+nome+', '+email+', '+''+', '+telefone+', '+mensagem);$.ajax({type:"POST",url:GLOBAL_URL+"frontend/Contact/visit/",data:datastring,dataType:"json",success:function(data){if(data.result){app.components.modal.alert({text:data.message,title:':)'});setTimeout(function(){location.reload();},3000);}else{app.components.modal.alert({text:data.message,title:' '});$(form).find('button').removeClass('desactive');$(form).find('button').html('<span>ENVIAR</span>');_toogle=false;}}});_toogle=true;}},ignore:'.ignore',errorElement:'span',rules:{name:'required',email:{required:true,email:true},phone:{required:true,minlength:15,},hora:'required',building:'required',message:'required',},messages:{name:"Por favor digite seu nome.",email:{required:"Por favor digite seu email.",email:"Por favor digite um email vÃ¡lido."},phone:{required:"Por favor digite seu Telefone.",minlength:"NÃºmero invÃ¡lido."},hora:"Por favor escolha a data da visita.",building:"Por favor escolha o empreendimento.",message:"Por favor digite sua mensagem.",},highlight:function(element,errorClass,validClass){$(element).parent().addClass(errorClass);},unhighlight:function(element,errorClass,validClass){$(element).parent().removeClass(errorClass);},});}
function validadeSellLand(){var _toogle=false;$(this).find('form').validate({submitHandler:function(form){$(form).find('.button').addClass('desactive');$(form).find('.button').html('<span>AGUARDE...</span>');if(!_toogle){var formData=new FormData(form);$.ajax({type:"POST",url:GLOBAL_URL+"frontend/Contact/send_terreno/",data:formData,contentType:false,processData:false,dataType:"json",success:function(data){console.log('ajax success');if(data.result){app.components.modal.alert({text:data.message,title:':)'});setTimeout(function(){location.reload();},3000);}else{app.components.modal.alert({text:data.message,title:' '});$(form).find('.button').removeClass('desactive');$(form).find('.button').html('<span>ENVIAR</span>');_toogle=false;}}});_toogle=true;}},ignore:'.ignore',errorElement:'span',rules:{person:{required:true,},name:'required',email:{required:true,email:true},phone:{required:true,minlength:15,},address:'required',cep:{required:true,minlength:9,},neighborhood:'required',city:'required',state_code:{required:true,},price:'required',area:'required',},messages:{person:{required:"Por favor informe se o terreno Ã© seu.",},name:"Por favor digite seu nome.",email:{required:"Por favor digite seu email.",email:"Por favor digite um email vÃ¡lido."},phone:{required:"Por favor digite seu Telefone.",minlength:"NÃºmero invÃ¡lido."},address:"Por favor digite o EndereÃ§o do seu terreno.",cep:{required:"Por favor digite o CEP do seu terreno.",minlength:"CEP InvÃ¡lido."},neighborhood:"Por favor digite o Bairro do seu terreno.",city:"Por favor digite a Cidade do seu terreno.",state_code:{required:"Por favor escolha o Estado do seu terreno.",},price:"Por favor digite o preÃ§o do seu terreno.",area:"Por favor digite a Ãrea mÂ² do seu terreno.",},highlight:function(element,errorClass,validClass){$(element).parent().addClass(errorClass);},unhighlight:function(element,errorClass,validClass){$(element).parent().removeClass(errorClass);},});}
function validateWork(){var _toogle=false;$(this).find('form').validate({debug:true,submitHandler:function(form){$(form).find('.button').addClass('desactive');$(form).find('.button').html('<span>AGUARDE...</span>');if(!_toogle){var formData=new FormData(form);$.ajax({type:"POST",url:GLOBAL_URL+"frontend/Contact/send_work/",data:formData,contentType:false,processData:false,dataType:"json",success:function(data){if(data.result){app.components.modal.alert({text:data.message,title:':)'});setTimeout(function(){location.reload();},3000);}else{app.components.modal.alert({text:data.message,title:' '});$(form).find('.button').removeClass('desactive');$(form).find('.button').html('<span>ENVIAR</span>');_toogle=false;}}});_toogle=true;}},ignore:'.ignore',errorElement:'span',rules:{name:'required',document:{required:true,cpf:true,minlength:11,},area:{required:true,},cargo:{required:true,},userfile:{required:true,accept:"application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document"}},messages:{name:"Por favor digite seu nome.",document:{required:"Por favor digite seu CPF.",minlength:"EstÃ¡ faltando nÃºmeros em seu CPF.",remote:"CPF jÃ¡ cadastrado."},area:{required:"Por favor escolha sua Ã¡rea de atuaÃ§Ã£o.",},cargo:{required:"Por favor escolha seu cargo.",},userfile:{required:"Por favor faÃ§o o upload do seu CV.",accept:"ExtensÃ£o de arquivo nÃ£o aceita.",},},highlight:function(element,errorClass,validClass){$(element).parent().addClass(errorClass);},unhighlight:function(element,errorClass,validClass){$(element).parent().removeClass(errorClass);},});}
$.validator.addMethod("date",function(value,element){var check=false;var re=/^\d{1,2}\/\d{1,2}\/\d{4}$/;var adata=value.split('-');var gg=parseInt(adata[2],10);var mm=parseInt(adata[1],10);var aaaa=parseInt(adata[0],10);var xdata=new Date(aaaa,mm-1,gg);if((xdata.getFullYear()==aaaa)&&(xdata.getMonth()==mm-1)&&(xdata.getDate()==gg))
check=true;else
check=false;return this.optional(element)||check;},"Insira uma data vÃ¡lida");$.validator.addMethod('greaterThan',function(value,element,params){var parts=value.split('/');var birthday=idade(parts[2],parts[1],parts[0]);if(params<=birthday)return true;},'VocÃª deve ter mais de 18 anos.');$.validator.addMethod('lessThan',function(value,element,params){var parts=value.split('/');var birthday=idade(parts[2],parts[1],parts[0]);if(params>birthday)return true;},'VocÃª deve ter menos de 120 anos.');$.validator.addMethod('cpf',function(value,element){value=jQuery.trim(value);value=value.replace('.','');value=value.replace('.','');cpf=value.replace('-','');while(cpf.length<11)cpf="0"+cpf;var expReg=/^0+$|^1+$|^2+$|^3+$|^4+$|^5+$|^6+$|^7+$|^8+$|^9+$/;var a=[];var b=new Number;var c=11;for(i=0;i<11;i++){a[i]=cpf.charAt(i);if(i<9)b+=(a[i]*--c);}
if((x=b%11)<2){a[9]=0}else{a[9]=11-x}
b=0;c=11;for(y=0;y<10;y++)b+=(a[y]*c--);if((x=b%11)<2){a[10]=0;}else{a[10]=11-x;}
var retorno=true;if((cpf.charAt(9)!=a[9])||(cpf.charAt(10)!=a[10])||cpf.match(expReg))retorno=false;return this.optional(element)||retorno;},'Informe um CPF vÃ¡lido');function idade(ano_aniversario,mes_aniversario,dia_aniversario){var d=new Date,ano_atual=d.getFullYear(),mes_atual=d.getMonth()+1,dia_atual=d.getDate(),ano_aniversario=+ano_aniversario,mes_aniversario=+mes_aniversario,dia_aniversario=+dia_aniversario,quantos_anos=ano_atual-ano_aniversario;if(mes_atual<mes_aniversario||mes_atual==mes_aniversario&&dia_atual<dia_aniversario){quantos_anos--;}
return quantos_anos<0?0:quantos_anos;}
module.exports={init:init,condition:$cont,args:arguments,}},{}],11:[function(require,module,exports){var $html=$('html');var $cont=$('.header');var $btHmbgr=$cont.find('.hmbgr');var $btGet=$cont.find('.btGetTouch');var $icons=$cont.find('.icons');var prevScrollTop=0;var breakPoint=200;function init(){$btHmbgr.on('click',function(){if($(this).hasClass('active')){app.components.menu.closeMenu();$(this).addClass('motion-out');}else{$cont.addClass('m-open');$(this).addClass('closed').addClass('motion-out');app.components.menu.openMenu();$btGet.removeClass('closed');$cont.find('.icons').removeClass('open');}});$btGet.on('click',function(){if($(this).hasClass('closed')){$(this).removeClass('closed');$cont.find('.icons').removeClass('open');}else{$cont.find('.icons').addClass('open');$(this).addClass('closed');}});$(window).on('scroll.header',onScroll);onScroll();}
function onScroll(){var dHeight=$(document).height();var wHeight=$(window).height();var scrollTop=$(window).scrollTop();var isScrollingUp=prevScrollTop-scrollTop>0?true:false;if(scrollTop<breakPoint){$cont.removeClass('force-hide').removeClass('visible');}
else if(scrollTop+wHeight>=dHeight){$cont.addClass('visible');}
prevScrollTop=scrollTop;}
function changeTagGoogle(_slug){$icons.find('.mail').find('.svg').addClass('mkt-ico-mail-'+_slug);$icons.find('.phone').find('.svg').addClass('mkt-ico-phone-'+_slug);$icons.find('.chat').find('.svg').addClass('mkt-ico-chat-'+_slug);$icons.find('.whats').find('.svg').addClass('mkt-ico-whats-'+_slug);}
function changeIdCrm(_id){$icons.find('.mail').attr('data-modal',GLOBAL_URL+'frontend/Modals/formulario/'+_id);$icons.find('.chat').attr('onclick',"javascript:openHypno("+_id+");");$icons.find('.whats').attr('onclick',"javascript:openHypno("+_id+");");}
module.exports={init:init,condition:$cont,changeTagGoogle:changeTagGoogle,changeIdCrm:changeIdCrm,args:arguments,}},{}],12:[function(require,module,exports){var $main=$('.main-content');var $cont=$('.home');var $gallery=$cont.find('.gallery');var $slidesGallery=$gallery.find('.slides:not(.over)');var $slidesOver=$gallery.find('.slides.over');var $webdoor=$cont.find('.webdoor');var $slides=$webdoor.find('.slides');var $infoItem=$webdoor.find('.info');var _title=null;var _link=null;var _button=null;var _color=null;var _video=null;var _time=8000;var _current=0;function init(){$cont.on('enter',motionIn);$cont.on('leave',motionOut);$main.data('motion-out-time',2000);if($(document).find('main').attr('data-page')=='home'){$(window).scroll(function(event){var scroll=$(window).scrollTop();if($(document).find('main').attr('data-page')=='home'){if(scroll>10){$('.header').css('margin-top','0px');}else{$('.header').css('margin-top','39px');}}else{$('.header').css('margin-top','0px');}});}else{$('.header').css('margin-top','0px');}
$slidesGallery.each(function(i,e){initFlick(e);});$slidesOver.each(function(i,e){initFlickOver(e);});$slides.slick({arrows:true,dots:true,autoplay:true,autoplaySpeed:_time,pauseOnHover:false,cssEase:'cubic-bezier(.55,.085,0,.99)',speed:900,fullscreen:true,});$slides.on('afterChange',function(e,slick,current){var $next=slick.$slides.eq(current);$next.addClass('motion-in');motionInInfo();});$slides.on('beforeChange',function(e,slick,current,next){var $next=slick.$slides.eq(next);var $current=slick.$slides.eq(current);_title=$next.data('title');_button=$next.data('subtitle');_link=$next.data('link');_color=$next.data('color');_video=$next.data('video');motionOutInfo();$current.removeClass('motion-in');setTimeout(function(){setInfo();},400);});setTimeout(function(){motionInInfo();$slides.eq(0).addClass('motion-in');$slides.slick('slickGoTo',0);},3000);}
function initFlick(e){$(e).flickity({contain:true,pageDots:false,wrapAround:true,selectedAttraction:0.01,friction:0.15,prevNextButtons:false,});$(e).parent().find('.a-prev').on('click',function(){$(e).flickity('previous');$(e).parent().find('.over').flickity('previous');});$(e).parent().find('.a-next').on('click',function(){$(e).flickity('next');$(e).parent().find('.over').flickity('next');});$(e).flickity('selectCell',0);$(e).parent().find('.btZoom').on('click',function(){if($(this).hasClass('active')){$(this).removeClass('active');$(this).parent().find('.slides:not(.over)').removeClass('zoom');$(this).parent().removeClass('zoom');$(e).flickity('exitFullscreen');}else{$(this).addClass('active');$(this).parent().find('.slides:not(.over)').addClass('zoom');$(this).parent().addClass('zoom');$(e).flickity('viewFullscreen');}});}
function initFlickOver(e){$(e).flickity({contain:true,pageDots:false,wrapAround:true,selectedAttraction:0.01,friction:0.15,prevNextButtons:false,draggable:false});var flkty=$(e).data('flickity');$(e).on('scroll.flickity',function(event,progress){var _this=$(e);if($(window).width()>861){flkty.slides.forEach(function(slide,i){var img=$(_this).find('.images')[i];var length=$(_this).find('.images').length;var range=$(_this).width()/3;var r=slide.target;var x=(r+flkty.x)*-1/3;switch(i){case 0:if(x>=(range*(length-1))){x=((r+flkty.x)*-1/3)-(range*(length));}
break;case length-1:if(x<=-(range*(length-1))){x=((r+flkty.x)*-1/3)+(range*(length));}
break;}
$(img).css('background-position-x',x+'px');});}});$(e).flickity('selectCell',1);}
function setInfo(){$infoItem.attr('data-color',_color);$infoItem.find('.button:not(.btvideo) span').html(_button);$infoItem.find('.button:not(.btvideo)').attr('href',_link);$infoItem.find('.link:not(.btvideo)').attr('href',_link);$infoItem.find('h1').html(_title);$infoItem.find('.btvideo').attr('data-video',_video);$infoItem.find('.button').removeClass('black').removeClass('white').addClass(_color);$webdoor.find('.arrow').removeClass('black').removeClass('white').addClass(_color);$webdoor.find('.arrows').removeClass('black').removeClass('white').addClass(_color);$webdoor.find('.scroll').attr('data-color',_color);if(_link.indexOf("Modals")>0){$webdoor.find('.a-link').attr('data-modal',_link);$webdoor.find('.a-link').removeAttr('href');$infoItem.find('.knowmore').attr('data-modal',_link);$infoItem.find('.knowmore').removeAttr('href');}else{$webdoor.find('.a-link').attr('href',_link);$webdoor.find('.a-link').removeAttr('data-modal');$infoItem.find('.knowmore').attr('href',_link);$infoItem.find('.knowmore').removeAttr('data-modal');}
if(_video==''){$infoItem.find('.btvideo').hide();if(_link==''){$infoItem.find('.knowmore ').hide();}else{$infoItem.find('.knowmore ').show();}}else{$infoItem.find('.btvideo').show();if(_link==''){$infoItem.find('.knowmore ').hide();}else{$infoItem.find('.knowmore ').show();}}
if(!_button){$infoItem.find('.button:not(.btvideo)').hide();}else{$infoItem.find('.button:not(.btvideo)').show();}}
function motionOutInfo(){$infoItem.find('h1').removeClass('motion-in');$infoItem.find('.button').removeClass('motion-in');$infoItem.find('.knowmore').removeClass('motion-in');}
function motionInInfo(){setTimeout(function(){$infoItem.find('.button').addClass('motion-in');$infoItem.find('.knowmore').addClass('motion-in');$infoItem.find('h1').addClass('motion-in');},400);}
function motionIn(e,oldPage){if($(document).find('main').attr('data-page')=='home'){if($(window).scrollTop()>10){$('.header').css('margin-top','0px');}else{$('.header').css('margin-top','39px');}}else{$('.header').css('margin-top','0px');}
setTimeout(function(){$webdoor.find('.w-background').addClass('motion-in');setTimeout(function(){$webdoor.find('.arrows').addClass('motion-in');$webdoor.find('.arrows').find('.button').addClass('motion-in');$webdoor.find('.scroll').addClass('motion-in');$cont.find('.sub-webdoor').addClass('motion-in');},1000);},100);}
function motionOut(e,newPage){$('.header').css('margin-top','0px');setTimeout(function(){$webdoor.find('.w-background').removeClass('motion-in');$webdoor.find('.button').removeClass('motion-in');$webdoor.find('h1').removeClass('motion-in');$webdoor.find('.scroll').removeClass('motion-in');$webdoor.find('.arrows').removeClass('motion-in');$cont.find('.sub-webdoor').removeClass('motion-in');},500);}
module.exports={init:init,condition:$cont,args:arguments,}},{}],13:[function(require,module,exports){var $cont=$('.instagram');var $btNext=$cont.find('.a-next');var $btPrev=$cont.find('.a-prev');function init(){$.instagramFeed({'username':'skr_arquitetura_viva','container':"#instagram-feed",'display_profile':false,'display_biography':false,'display_gallery':true,'callback':null,'styling':true,'items':5,'items_per_row':5,'margin':0,});setTimeout(function(){$cont.find('a').addClass('external').addClass('swiper-slide');setTimeout(function(){var mySwiper=new Swiper($cont.find('.swiper-container'),{direction:'horizontal',slidesPerView:5,spaceBetween:0,navigation:{nextEl:$btNext,prevEl:$btPrev,},breakpoints:{860:{slidesPerView:2,spaceBetween:0,},414:{slidesPerView:1,spaceBetween:0,},},});},2000);},5000);}
module.exports={init:init,condition:$cont,args:arguments,}},{}],14:[function(require,module,exports){var $cont=$('.loader');function init(){}
function update(pcent){}
function show(){$cont.css({'display':'block'});setTimeout(function(){$cont.addClass('motion-in');},100);}
function out(){$cont.addClass('motion-out');setTimeout(function(){$cont.css({'display':'none'});$cont.removeClass('motion-out').removeClass('motion-in');},1000);}
function hide(){}
module.exports={init:init,loaderIn:show,loaderOut:out,loaderHide:hide,loaderVal:update,condition:$cont,}},{}],15:[function(require,module,exports){var $cont=$('.location');var $map=$cont.find('.l-map');var $infoMap=$cont.find('.l-infos');var $infoNext=$cont.find('.a-next');var $infoPrev=$cont.find('.a-prev');var markers=[];var features=[];var count=0;var _cont=1;var _cc=0;function init(){features=GLOBAL_MAP;count=Object.keys(features).length;window.initGmaps=function(){buildMap();}
if($map.is(':visible')){if(window.google&&window.google.maps)initGmaps();else app.loadScript('//maps.googleapis.com/maps/api/js?key='+(app.get('gkey')||'AIzaSyCZDAmjlUz5FY4bNaQlagvRZg2ysi92VA4')+'&callback=initGmaps');}}
function buildMap(){var lat=-23.5547809;var lng=-46.6699865;var coords=new google.maps.LatLng(lat,lng);var mapOptions={scaleControl:false,draggable:true,scrollwheel:false,streetViewControl:false,panControl:true,mapTypeId:google.maps.MapTypeId.ROADMAP,zoom:13,center:new google.maps.LatLng(lat,lng),styles:[{"featureType":"water","elementType":"geometry","stylers":[{"color":"#e9e9e9"},{"lightness":17}]},{"featureType":"landscape","elementType":"geometry","stylers":[{"color":"#f5f5f5"},{"lightness":20}]},{"featureType":"road.highway","elementType":"geometry.fill","stylers":[{"color":"#ffffff"},{"lightness":17}]},{"featureType":"road.highway","elementType":"geometry.stroke","stylers":[{"color":"#ffffff"},{"lightness":29},{"weight":0.2}]},{"featureType":"road.arterial","elementType":"geometry","stylers":[{"color":"#ffffff"},{"lightness":18}]},{"featureType":"road.local","elementType":"geometry","stylers":[{"color":"#ffffff"},{"lightness":16}]},{"featureType":"poi","elementType":"geometry","stylers":[{"color":"#f5f5f5"},{"lightness":21}]},{"featureType":"poi.park","elementType":"geometry","stylers":[{"color":"#dedede"},{"lightness":21}]},{"elementType":"labels.text.stroke","stylers":[{"visibility":"on"},{"color":"#ffffff"},{"lightness":16}]},{"elementType":"labels.text.fill","stylers":[{"saturation":36},{"color":"#333333"},{"lightness":40}]},{"elementType":"labels.icon","stylers":[{"visibility":"off"}]},{"featureType":"transit","elementType":"geometry","stylers":[{"color":"#f2f2f2"},{"lightness":19}]},{"featureType":"administrative","elementType":"geometry.fill","stylers":[{"color":"#fefefe"},{"lightness":20}]},{"featureType":"administrative","elementType":"geometry.stroke","stylers":[{"color":"#fefefe"},{"lightness":17},{"weight":1.2}]}],};map=new google.maps.Map($map[0],mapOptions);for(var i=0;i<count;i++){var _lat=features[i].lat;var _lgt=features[i].lgt;var _int=features[i].int;markers[i]=new google.maps.Marker({position:new google.maps.LatLng(_lat,_lgt),icon:{url:"public/frontend/img/ico-pin.svg",scaledSize:new google.maps.Size(50,50),},map:map,});}
$(markers).each(function(e){markers[e].addListener('click',function(){setInfoMap((e+1));$cont.find('.i-container').addClass('active');});})
$cont.find('.closeBT').click(function(){$cont.find('.i-container').removeClass('active');setInfoMap((i=false));});}
function setInfoMap(_int){for(var i=0;i<count;i++){if(i==(_int-1)){markers[i].setIcon({url:GLOBAL_URL+"public/frontend/img/ico-pin-enable.svg",scaledSize:new google.maps.Size(50,50),});markers[i].setZIndex(500);}else{markers[i].setIcon({url:GLOBAL_URL+"public/frontend/img/ico-pin.svg",scaledSize:new google.maps.Size(50,50),});markers[i].setZIndex(100);}}
$infoMap.find('.title').html(' ');$infoMap.find('.sub-title').html(' ');$infoMap.find('a').attr('href',' ');$infoMap.find('.l-image').attr('style','background-image: url( )');$infoMap.find('.title').html(features[_int-1].name);$infoMap.find('.sub-title').html(features[_int-1].address);$infoMap.find('a').attr('href',features[_int-1].link);$infoMap.find('.l-image').attr('style','background-image: url('+features[_int-1].image+')');}
module.exports={init:init,condition:$cont,args:arguments,}},{}],16:[function(require,module,exports){var $cont=$('.menu');var submenu=$cont.find('.submenu');function init(){$submenu.on('mouseenter',function(){$cont.find('.grayDark').addClass('motion-in');console.log('hover');})
$submenu.on('mouseleave',function(){$cont.find('.grayDark').removeClass('motion-in');})
console.log('menu');}
function openMenu(){$cont.addClass('m-open');setTimeout(function(){$cont.find('.gray').addClass('motion-in');$cont.find('.black').addClass('motion-in');$cont.find('.grayDark').addClass('motion-in');$cont.find('.copyright').addClass('motion-in');$cont.find('.logo').addClass('motion-in');$cont.find('.item').each(function(i,e){var _this=$(this);setTimeout(function(){$(_this).addClass('motion-in');},i*100);});setTimeout(function(){$cont.find('.text').addClass('motion-in');$cont.find('.ico').each(function(i,e){var _this=$(this);setTimeout(function(){$(_this).addClass('motion-in');},i*100);});setTimeout(function(){$('.hmbgr').addClass('active').removeClass('motion-out');},400);},400);},100);}
function closeMenu(){$cont.find('.item').removeClass('motion-in');$cont.find('.ico').removeClass('motion-in');$cont.find('.text').removeClass('motion-in');$cont.find('.copyright').removeClass('motion-in');$cont.find('.logo').removeClass('motion-in');setTimeout(function(){$cont.find('.gray').removeClass('motion-in');$cont.find('.black').removeClass('motion-in');$cont.find('.grayDark').removeClass('motion-in');$('.hmbgr').removeClass('closed');setTimeout(function(){$cont.removeClass('m-open');$('.header').removeClass('m-open');setTimeout(function(){$('.hmbgr').removeClass('active').removeClass('motion-out');},500);},1000);},500);console.log('ajutes');}
module.exports={init:init,closeMenu:closeMenu,openMenu:openMenu,args:arguments,}},{}],17:[function(require,module,exports){var $html=$('html');var $btClose=$('.modal-wrapper').find('.bt-close');function init(){if(GLOBAL_BUILDING!=''){if(GLOBAL_BUILDING!='nao-enviado'){open(GLOBAL_URL+'frontend/Modals/agenda_visita/'+GLOBAL_BUILDING);}else{open(GLOBAL_URL+'frontend/Modals/agenda_visita/');}}
$html.on('click','[data-modal]',function(e){e.preventDefault();open($(this).data('modal'));});}
function alert(opts){var html=app.templates.alert.render(opts);render(html);}
function video(opts){var html=app.templates.video.render(opts);render(html);}
function open(url){var promise=$.ajax({url:url});promise.error(function(){location.href=url;}).success(function(resp){render(resp);});}
function render(html){var $wrapper=$(app.templates.modal.render()).hide().appendTo('body');var $container=$wrapper.find('.modal-content');var $modal=$(html).appendTo($container);var $btClose=$modal.find('.bt-close, [data-action="close"]');var $hint=$modal.find('.hint');var $gallery=$wrapper.find('.gallery');var $slides=$gallery.find('.slides');var $select=$wrapper.find('.select');var $selectModalBt=$('.select-modal');var $selectModal=$selectModalBt.find('.d-item');app.initComponents($wrapper);open();selectModal();$modal.on('close',close);$btClose.on('click',function(e){e.preventDefault();close();});$wrapper.on('click',function(e){if(!$(e.target).closest('.modal').length)close();});$select.find('a').on('click',function(e){var _this=$(this);close();setTimeout(function(){app.components.modal.open($(_this).data('modal'));},100);});$hint.on('click',function(){close();});$(document).keyup(function(e){if(e.keyCode===27)close();});function open(){$wrapper.fadeIn(400);}
function close(){$wrapper.remove();}
function selectModal(){$selectModalBt.on('click',function(){console.log('clique');if($(this).hasClass('active')){$(this).removeClass('active');}else{$(this).addClass('active');}});$selectModal.on('click',function(){var _data=$(this).find('a').data('filter');$selectModal.removeClass('active');$(this).addClass('active');if($selectModalBt.hasClass('active')){$(this).removeClass('active');}
$cont.find('.select-modal .label').text($(this).find('a').text());});}
$slides.each(function(i,e){initFlick(e);});function initFlick(e){$(e).flickity({contain:true,pageDots:false,wrapAround:true,selectedAttraction:0.01,friction:0.15,prevNextButtons:false,draggable:false});$(e).parent().find('.a-prev').on('click',function(){$(e).flickity('previous');});$(e).parent().find('.a-next').on('click',function(){$(e).flickity('next');});$(e).flickity('selectCell',0);if($(e).hasClass('over')){$(e).flickity('selectCell',1);}}}
module.exports={init:init,alert:alert,video:video,open:open,condition:$html,}},{}],18:[function(require,module,exports){var $main=$('.main-content');var $cont=$('.new');var $cont_social=$('.social-n');var $gallery=$cont.find('.gallery');var $slides=$gallery.find('.slides');var $webdoor=$cont.find('.webdoor');var _shareURL=location.href;var _shareTitle=document.title;var _shareText=document.querySelector("meta[property='og:description']").getAttribute("content");var _shareImg=$gallery.find('.slides').find('.images');var _shareLine=_shareTitle+': '+_shareText;var $btFacebook=$cont_social.find('.i-facebook');var $btTwitter=$cont_social.find('.i-twitter');var $btWhatsapp=$cont_social.find('.i-whatsapp');function init(){$cont.on('enter',motionIn);$cont.on('leave',motionOut);$main.data('motion-out-time',2000);$slides.each(function(i,e){initFlick(e);});socialNetwork();}
function initFlick(e){$(e).flickity({contain:true,pageDots:false,wrapAround:true,selectedAttraction:0.01,friction:0.15,prevNextButtons:false,draggable:false});$(e).parent().find('.a-prev').on('click',function(){$(e).flickity('previous');});$(e).parent().find('.a-next').on('click',function(){$(e).flickity('next');});$(e).flickity('selectCell',0);}
function socialNetwork(){$btTwitter.on('click',function(){app.popup('http://twitter.com/share?url='+encodeURIComponent(_shareURL)+'&text='+encodeURIComponent(_shareText),600,350);});$btFacebook.on('click',function(){FB.ui({app_id:243211436306700,method:'feed',display:'popup',link:_shareURL,},function(e){console.log('Facebook Feed.',e);});});$btWhatsapp.on('click',function(){window.open("https://api.whatsapp.com/send?text="+encodeURIComponent(_shareURL));});}
function motionIn(e,oldPage){if($(document).find('main').attr('data-page')=='home'){if($(window).scrollTop()>10){$('.header').css('margin-top','0px');}else{$('.header').css('margin-top','39px');}}else{$('.header').css('margin-top','0px');}
$webdoor.find('.w-background').addClass('motion-in');setTimeout(function(){$webdoor.find('.scroll').addClass('motion-in');setTimeout(function(){$cont.find('.content').addClass('motion-in');},500);},500);}
function motionOut(e,newPage){$('.header').css('margin-top','0px');setTimeout(function(){$cont.find('.content').removeClass('motion-in');setTimeout(function(){$webdoor.find('.w-background').removeClass('motion-in');$webdoor.find('.scroll').removeClass('motion-in');},500);},1000);}
module.exports={init:init,condition:$cont,args:arguments,}},{}],19:[function(require,module,exports){var $cont=$('.news-home');var $gallery=$cont.find('.n-gallery');function init(){$gallery.each(function(i,e){addSwipe(e);});}
function addSwipe(_target){var $btNext=$(_target).find('.a-next');var $btPrev=$(_target).find('.a-prev');var mySwiper=new Swiper($(_target).find('.swiper-container'),{direction:'horizontal',slidesPerView:3,loop:true,infinite:true,spaceBetween:40,navigation:{nextEl:$btNext,prevEl:$btPrev,},breakpoints:{768:{slidesPerView:2,spaceBetween:20,},414:{slidesPerView:1,spaceBetween:0,},},})}
module.exports={init:init,condition:$cont,args:arguments,}},{}],20:[function(require,module,exports){var $main=$('.main-content');var $cont=$('.news');var $webdoor=$cont.find('.webdoor');function init(){$cont.on('enter',motionIn);$cont.on('leave',motionOut);$main.data('motion-out-time',2000);}
function motionIn(e,oldPage){if($(document).find('main').attr('data-page')=='home'){if($(window).scrollTop()>10){$('.header').css('margin-top','0px');}else{$('.header').css('margin-top','39px');}}else{$('.header').css('margin-top','0px');}
setTimeout(function(){$webdoor.find('.button').addClass('motion-in');$webdoor.find('h1').addClass('motion-in');$webdoor.find('.paragraph').addClass('motion-in');setTimeout(function(){$webdoor.find('.breadcrumb').addClass('motion-in');$webdoor.find('.scroll').addClass('motion-in');},500);},500);}
function motionOut(e,newPage){$('.header').css('margin-top','0px');setTimeout(function(){$webdoor.find('.button').removeClass('motion-in');$webdoor.find('h1').removeClass('motion-in');$webdoor.find('.scroll').removeClass('motion-in');$webdoor.find('.breadcrumb').removeClass('motion-in');$webdoor.find('.paragraph').removeClass('motion-in');},500);}
module.exports={init:init,condition:$cont,args:arguments,}},{}],21:[function(require,module,exports){var $cont=$('.numbers');var $number=$cont.find('.number');function init(){$(window).on('scroll.numbers',onScroll);onScroll();}
function onScroll(){$number.each(function(){if(isInViewport($(this))){if(!$(this).hasClass('active')){motionNumber($(this));}}});}
function motionNumber(_this){var $this=$(_this);var countTo=$this.attr('data-count');$this.addClass('active');$({countNum:$this.text()}).animate({countNum:countTo},{duration:3000,easing:'linear',step:function(){$this.find('.n-decimal').text(Math.floor(this.countNum));},complete:function(){$this.find('.n-decimal').text(this.countNum);}});}
function isInViewport(_this){var elementTop=$(_this).offset().top;var elementBottom=elementTop+$(_this).outerHeight();var viewportTop=$(window).scrollTop();var viewportBottom=viewportTop+$(window).height();return elementBottom>viewportTop&&elementTop<viewportBottom;}
module.exports={init:init,condition:$cont,args:arguments,}},{}],22:[function(require,module,exports){var $cont=$('.pages');var $footer=$('.footer');var $header=$('.header');var _id_cerm=$cont.data('id_crm');function init(){setTimeout(function(){_idCrm=$('.pages').data('id_crm');if(_idCrm==undefined)_idCrm="2";app.components.header.changeIdCrm(_idCrm);},2000);$(window).bind('scroll.pages',scroll);}
function scroll(){var _scrollTop=null;_scrollTop=$(window).scrollTop();if($(window).scrollTop()+$(window).height()>=($(document).height()-424)){$footer.removeClass('hide').addClass('motion-in');}else{$footer.addClass('hide').removeClass('motion-in');}}
function changeIdCrm(_id){$icons.find('.mail').attr('data-modal',GLOBAL_URL+'frontend/Modals/formulario/'+_id);$icons.find('.chat').attr('onclick',"javascript:openHypno("+_id+");");$icons.find('.whats').attr('onclick',"javascript:openHypno("+_id+");");}
module.exports={init:init,condition:$cont,changeIdCrm:changeIdCrm,args:arguments,}},{}],23:[function(require,module,exports){var $main=$('.main-content');var $cont=$('.partnes');var $webdoor=$cont.find('.webdoor');var $slides=$webdoor.find('.slides');var $infoItem=$webdoor.find('.info');var _time=8000;function init(){$cont.on('enter',motionIn);$cont.on('leave',motionOut);$main.data('motion-out-time',2000);$slides.slick({arrows:false,dots:true,autoplay:true,autoplaySpeed:_time,pauseOnHover:false,cssEase:'cubic-bezier(.55,.085,0,.99)',speed:900,fullscreen:true,});}
function motionIn(e,oldPage){if($(document).find('main').attr('data-page')=='home'){if($(window).scrollTop()>10){$('.header').css('margin-top','0px');}else{$('.header').css('margin-top','39px');}}else{$('.header').css('margin-top','0px');}
$webdoor.find('.w-background').addClass('motion-in');setTimeout(function(){$webdoor.find('.button').addClass('motion-in');$webdoor.find('h1').addClass('motion-in');setTimeout(function(){$webdoor.find('.breadcrumb').addClass('motion-in');$webdoor.find('.scroll').addClass('motion-in');setTimeout(function(){$cont.find('.content').addClass('motion-in');$cont.find('.numbers').addClass('motion-in');},500);},500);},500);}
function motionOut(e,newPage){$('.header').css('margin-top','0px');setTimeout(function(){$cont.find('.content').removeClass('motion-in');$cont.find('.numbers').removeClass('motion-in');setTimeout(function(){$webdoor.find('.w-background').removeClass('motion-in');$webdoor.find('.button').removeClass('motion-in');$webdoor.find('h1').removeClass('motion-in');$webdoor.find('.breadcrumb').removeClass('motion-in');$webdoor.find('.scroll').removeClass('motion-in');},500);},1000);}
module.exports={init:init,condition:$cont,args:arguments,}},{}],24:[function(require,module,exports){var $cont=$('.status');var $number=$cont.find('.number');function init(){$(window).on('scroll.numbers',onScroll);onScroll();}
function onScroll(){$number.each(function(){if(isInViewport($(this))){if(!$(this).hasClass('active')){motionNumber($(this));var _id=$(this).data('id');console.log(_id);setCircleTo(_id,$(this).data('count'));}}});}
function motionNumber(_this){var $this=$(_this);var countTo=$this.attr('data-count');$this.addClass('active');$({countNum:$this.text()}).animate({countNum:countTo},{duration:3000,easing:'linear',step:function(){$this.text(Math.floor(this.countNum)+'%');},complete:function(){$this.text(this.countNum+'%');}});}
function isInViewport(_this){var elementTop=$(_this).offset().top;var elementBottom=elementTop+$(_this).outerHeight();var viewportTop=$(window).scrollTop();var viewportBottom=viewportTop+$(window).height();return elementBottom>viewportTop&&elementTop<viewportBottom;}
function setCircleTo(_target,_percent){svg=document.getElementById(_target);svg.setAttribute('stroke-dasharray',_percent+', 100');}
module.exports={init:init,condition:$cont,args:arguments,}},{}],25:[function(require,module,exports){var $cont=$('.g-video');var $gallery=$cont.find('.v-gallery');var _windowWidth=$(window).width();function init(){$gallery.each(function(i,e){addSwipe(e);});}
function addSwipe(_target){var $btNext=$(_target).find('.a-next');var $btPrev=$(_target).find('.a-prev');var mySwiper=new Swiper($(_target).find('.swiper-container'),{direction:'horizontal',slidesPerView:3,loop:false,infinite:true,spaceBetween:40,navigation:{nextEl:$btNext,prevEl:$btPrev,},breakpoints:{768:{slidesPerView:2,spaceBetween:20,},414:{slidesPerView:1,spaceBetween:0,},},})
if(_windowWidth>1025){if($($gallery).find('.swiper-slide').length<4){$($gallery).find('.arrow').addClass('hideArrow');}}else if(_windowWidth>768){if($($gallery).find('.swiper-slide').length<3){$($gallery).find('.arrow').addClass('hideArrow');}}else if(_windowWidth>320){if($($gallery).find('.swiper-slide').length<2){$($gallery).find('.arrow').addClass('hideArrow');}}}
module.exports={init:init,condition:$cont,args:arguments,}},{}],26:[function(require,module,exports){var $cont=$('.video-frame');var $close=$cont.find('.bt-close');function init(){$close.on('click',function(){app.components.video.closeVideo();});}
module.exports={init:init,condition:$cont,args:arguments,}},{}],27:[function(require,module,exports){var $cont=$('.video');var $btVideo=$cont.find('.v-btPlay');var $video=$('.video-frame');var _inter=null;var player=null;function init(){$btVideo.on('click',function(){openVideo($(this).data('video'));console.log('Ã§lick');});console.log('INIT VIDEO');}
function openVideo(_youtube){$video.fadeIn(200);var id='vd'+parseInt(Math.random()*1e9);var youtubeID=_youtube;$('<div/>').attr('id',id).appendTo($video);onYTLoad(function(){player=new YT.Player(id,{videoId:youtubeID,playerVars:{rel:0,controls:1,autohide:1,wmode:'opaque',showinfo:0,iv_load_policy:3,modestbranding:1,},events:{onReady:onReady,onStateChange:onStateChange,},});});}
function closeVideo(){stop();$video.fadeOut(200);setTimeout(function(){$video.find('iframe').remove();},200);clearInterval(_inter);}
function onStateChange(e){if(e.data==-1||e.data==0||e.data==2){}else{}
if(e.data==0){closeVideo();}}
function onReady(){player.playVideo();}
function stop(){player.stopVideo();}
window.onYouTubePlayerAPIReady=function(){window.isYtLoaded=true;(window.ytCallbacks||[]).forEach(function(fn){fn();});}
function onYTLoad(callback){if(!window.requestedYTLib){window.requestedYTLib=true;loadScript('https://www.youtube.com/iframe_api');}
if(window.isYtLoaded){callback();}else{if(!window.ytCallbacks)window.ytCallbacks=[];window.ytCallbacks.push(callback);}}
function loadScript(src,callback){var s=document.createElement('script'),r=false,t;s.type='text/javascript';s.src=src;s.onload=s.onreadystatechange=function(){if(!r&&(!this.readyState||this.readyState=='complete')){r=true;if(typeof callback=='function')callback();}}
t=document.getElementsByTagName('script')[0];t.parentNode.insertBefore(s,t);}
module.exports={init:init,condition:$cont,openVideo:openVideo,closeVideo:closeVideo,args:arguments,}},{}],28:[function(require,module,exports){var $cont=$('.webdoor');var $scrollDown=$cont.find('.scroll');function init(){$scrollDown.on('click',function(){$('html,body').animate({'scrollTop':$(window).height()-250},500);});}
module.exports={init:init,condition:$cont,args:arguments,}},{}],29:[function(require,module,exports){module.exports=function(paramKey){var pairs=location.search.replace(/^\?/,'').split('&');var params=[];pairs.forEach(function(item){var split=item.split('=');var key=split[0];var val=split[1];params[key]=val;});var selected=params[paramKey];if(selected)selected=decodeURIComponent(selected.replace(/\+/gi,' '));return selected;}},{}],30:[function(require,module,exports){module.exports=function(elem){var $elem=$(elem||'body');Object.keys(app.components).forEach(function(key){var comp=app.components[key];if(elem){if(comp.condition){var selector=comp.condition.selector;if($elem.is(selector)||$elem.find(selector).length){var args=Array.prototype.slice.call(comp.args);comp.args.callee.apply(this,args);app.components[key]=args[1].exports;app.components[key].init();}}else if(comp.each){var selector=comp.each.selector;$elem.find(selector).each(comp.init);$elem.filter(selector).each(comp.init);}}
else{if(comp.condition){if(comp.condition.length)comp.init();}else if(comp.each){comp.each.each(comp.init);}}});}},{}],31:[function(require,module,exports){module.exports=function(src,callback){var s=document.createElement('script'),r=false,t;s.type='text/javascript';s.src=src;s.onload=s.onreadystatechange=function(){if(!r&&(!this.readyState||this.readyState=='complete')){r=true;if(typeof callback=='function')callback();}}
t=document.getElementsByTagName('script')[0];t.parentNode.insertBefore(s,t);}},{}],32:[function(require,module,exports){module.exports=function(opts){var before=opts.before||function(){};var progress=opts.progress||function(){};var complete=opts.complete||function(){};var testDelay=opts.testDelay||0;var $elem=$(opts.elem||'body');var urls=[];var queue=[];var isLoaded;$elem.find('*').add($elem).each(function(){var $elem=$(this);var bgImg=$elem.css('background-image');var bgUrl=(/(^url\([\'\"]?)([^\"\']*)([\'\"]?\))/.exec(bgImg)||[])[2];var url;if($elem.is('img'))url=$elem.attr('src');else if(bgUrl)url=bgUrl;if(url&&urls.indexOf(url)<0){urls.push(url);queue.push({src:url,progress:0});}});if(!urls.length)return complete(urls);before();function checkProgress(){var loaded=0;var total=queue.length;queue.forEach(function(item){loaded=loaded+item.progress;});var pcent=loaded*100/total;progress(pcent);if(pcent>=100&&!isLoaded){isLoaded=true;complete(urls);}}
queue.forEach(function(item,i){setTimeout(function(){var req=new XMLHttpRequest();req.onprogress=function(e){item.progress=e.loaded/e.total;checkProgress();};req.onloadend=req.ontimeout=req.onerror=req.onabort=function(e){item.progress=1;checkProgress();};req.open('GET',item.src,true);req.send(null);},testDelay*(i+1));});}},{}],33:[function(require,module,exports){var $title=$('title');var $menu=$('.menu');var $menus=$menu.find('a');var $header=$('.header');var $footer=$('.footer');var $bottom=$('.bottom');var $cont=$('.main-content');var $html=$('html');var $main=$('main');var $temp=$('<div></div>');var loadDelay=0;var oldPage;var promise;var timer;function init(){for(var i=0;i<800;i=i+50)setTimeout(function(){$(window).scrollTop(0);},i);var $loader=$('.loader-init');$loader.addClass('motion-in');setTimeout(function(){app.loader({elem:$('body'),testDelay:0,progress:function(pcent){},complete:function(){$loader.addClass('motion-out');setTimeout(function(){$loader.css({'display':'none'});},1000);$menu.trigger('enter').addClass('motion-in');$header.addClass('motion-in');$cont.find('> *').trigger('enter').addClass('motion-in').attr('data-url',location.href);setTimeout(function(){activeMenus($main.data('page'));},10);},});},500);$(document).on('click','a[href]:not(.external)',function(e){var url=$(this).attr('href');if(url.indexOf('mailto:')==0)return;if(url.indexOf('javascript:')==0)return;if($(this)[0].href==location.href)return true;e.preventDefault();change(url,$(this).data('page'));history.pushState(null,null,url);});setTimeout(function(){window.addEventListener('popstate',function(e){change(location.href);});},1000);}
function change(url,newPage){if(timer)clearTimeout(timer);if(promise&&promise.abort)promise.abort();var $currSec=$cont.find('> *');oldPage=$main.attr('data-page');promise=$.ajax({url:url});beforeLeave($currSec,oldPage,newPage);$currSec.trigger('leave',[newPage]).addClass('motion-out');app.components.menu.closeMenu();$menu.trigger('leave');$header.removeClass('motion-in');setTimeout(function(){app.components.loader.loaderVal(0);app.components.loader.loaderIn();setTimeout(function(){timer=setTimeout(function(){promise.error(function(){location.href=url;}).success(function(resp){handleHTML(resp);});},0);},1000);},$cont.data('motion-out-time')||800);}
function handleHTML(html){var $all=$(html);var $pageTitle=$all.filter('title');var $pageMenu=$all.find($menu.selector);var $pageHeader=$all.find($header.selector);var $pageFooter=$all.find($footer.selector);var $pageCont=$all.find($cont.selector);var $pageMain=$all.filter($main.selector);var $newSec=$pageCont.find('> *');var $oldSec=$cont.find('> *').not($newSec);var newPage=$pageMain.attr('data-page');var newCountry=$pageMain.attr('data-country');var $tempSec=$temp.find('> *');var isReused;if(location.href==$tempSec.data('location')&&$tempSec.data('persist')){$newSec=$tempSec;isReused=true;}
beforeLoadNew($newSec,$oldSec,oldPage,newPage);app.loader({elem:$newSec,testDelay:0,progress:function(pcent){app.components.loader.loaderVal(pcent);},complete:function(){app.components.loader.loaderOut();$title.html($pageTitle.html());$main.attr('data-page',newPage);$main.attr('class',$pageMain.attr('class'));$header.attr('class',$pageHeader.attr('class'));$footer.attr('class',$pageFooter.attr('class'));$menu.attr('class',$pageMenu.attr('class'));$menu.trigger('enter').addClass('motion-in');activeMenus(newPage);$newSec.hide().appendTo($cont);$oldSec.addClass('leaving');$newSec.show();if(!isReused)app.initComponents($newSec);app.svg();$('html,body').animate({scrollTop:0},1);$oldSec.stop().fadeOut($oldSec.data('motion-out-fade')||0,function(){$temp.empty();$oldSec.appendTo($temp).removeClass('leaving motion-in motion-out');setTimeout(function(){$newSec.trigger('enter',[oldPage]).addClass('motion-in');$newSec.attr('data-location',location.href);$header.addClass('motion-in');},1500);afterEnter($newSec,$oldSec,oldPage,newPage);});},});}
function beforeLeave($oldSec,oldPage,newPage){}
function beforeLoadNew($newSec,$oldSec,oldPage,newPage){}
function afterEnter($newSec,$oldSec,oldPage,newPage){}
function activeMenus(page){$('.menu').find('a').removeClass('active');$('.menu').find('a').filter('[data-page="'+page+'"]').addClass('active');}
module.exports=init;},{}],34:[function(require,module,exports){module.exports=function(url,width,height){var wLeft=window.screen.left||window.screenLeft||0;var wTop=window.screen.top||window.screenTop||0;var left=(window.screen.width/2)-((width/2)+10)+wLeft;var top=(window.screen.height/2)-((height/2)+50)+wTop;window.open(url,'popup'+url,'status=no, height='+height+', width='+width+', resizable=yes, left='+left+', top='+top+', screenX='+left+', screenY='+top+', toolbar=no, menubar=no, scrollbars=no, location=no, directories=no');}},{}],35:[function(require,module,exports){function init(){$('.svg').each(startClass);}
function startClass(){var $icon=$(this);if($icon.hasClass('svg-inline'))return true;var bg=$icon.css('background-image').replace('url(','').replace(')','').replace(/\"/g,'');if(bg&&bg!='none')$.get(bg,function(resp){$icon.html($(resp).find('svg')).addClass('svg-inline').trigger('svg-ready');});}
module.exports=init;},{}],36:[function(require,module,exports){var nunjucks=require("nunjucks");var env=nunjucks.env||new nunjucks.Environment();var obj=(function(){function root(env,context,frame,runtime,cb){var lineno=null;var colno=null;var output="";try{output+="\n<div class=\"modal mod-small\">\n\n\t<button class=\"bt-close svg-inline\">\n\t\t<svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\"\n\t\t\tviewBox=\"0 0 20.2 19.2\" style=\"enable-background:new 0 0 20.2 19.2;\" xml:space=\"preserve\">\n\t\t<path d=\"M10.8,9.6l9.2,8.8c0.2,0.2,0.2,0.5,0,0.7c-0.2,0.2-0.5,0.2-0.7,0l-9.2-8.8L0.8,19c-0.2,0.2-0.5,0.2-0.7,0\n\t\t\tc-0.2-0.2-0.2-0.5,0-0.7l9.2-8.8L0.1,0.8C0,0.6,0,0.3,0.1,0.1C0.3,0,0.6,0,0.8,0.1l9.2,8.8l9.2-8.8C19.5,0,19.8,0,20,0.1\n\t\t\tc0.2,0.2,0.2,0.5,0,0.7L10.8,9.6z\"/>\n\t\t</svg>\n\t</button>\n\n\t";if(runtime.contextOrFrameLookup(context,frame,"title")){output+="\n\t<h1 class=\"mod-title\">";output+=runtime.suppressValue(runtime.contextOrFrameLookup(context,frame,"title"),env.autoesc);output+="</h1>\n\t";;}
output+="\n\n\t";if(runtime.contextOrFrameLookup(context,frame,"text")){output+="\n\t<div class=\"mod-text\">\n\t\t\t";output+=runtime.suppressValue(runtime.contextOrFrameLookup(context,frame,"text"),env.autoesc);output+="\n\t</div>\n\t";;}
output+="\n\t";if(runtime.contextOrFrameLookup(context,frame,"button")){output+="\n\t\t<div class=\"mod-buttons-center\">\n\t\t\t<button class=\"mod-button\" data-action=\"close\">\n\t\t\t\t<span>";output+=runtime.suppressValue(runtime.contextOrFrameLookup(context,frame,"button"),env.autoesc);output+="</span>\n\t\t\t\t<span>";output+=runtime.suppressValue(runtime.contextOrFrameLookup(context,frame,"button"),env.autoesc);output+="</span>\n\t\t\t</button>\n\t\t</div>\n\t\t";;}
output+="\n</div>";cb(null,output);;}catch(e){cb(runtime.handleError(e,lineno,colno));}}
return{root:root};})();var oldRoot=obj.root;obj.root=function(env,context,frame,runtime,cb){var oldGetTemplate=env.getTemplate;env.getTemplate=function(name,ec,cb){if(typeof ec==="function"){cb=ec;ec=false;}
var _require=function(name){try{return require(name);}catch(e){if(frame.get("_require"))return frame.get("_require")(name)}};var tmpl=_require(name);frame.set("_require",_require);if(ec)tmpl.compile();cb(null,tmpl);};oldRoot(env,context,frame,runtime,function(err,res){env.getTemplate=oldGetTemplate;cb(err,res);});};var src={obj:obj,type:"code"};module.exports=new nunjucks.Template(src,env);},{"nunjucks":38}],37:[function(require,module,exports){var nunjucks=require("nunjucks");var env=nunjucks.env||new nunjucks.Environment();var obj=(function(){function root(env,context,frame,runtime,cb){var lineno=null;var colno=null;var output="";try{output+="<div class=\"modal-wrapper\">\n\t<div class=\"hint\"></div>\n\t<div class=\"modal-content\">\n\t\t";context.getBlock("content")(env,context,frame,runtime,function(t_2,t_1){if(t_2){cb(t_2);return;}
output+=t_1;output+="\n\t</div>\n</div>";cb(null,output);});}catch(e){cb(runtime.handleError(e,lineno,colno));}}
function b_content(env,context,frame,runtime,cb){var lineno=null;var colno=null;var output="";try{cb(null,output);;}catch(e){cb(runtime.handleError(e,lineno,colno));}}
return{b_content:b_content,root:root};})();var oldRoot=obj.root;obj.root=function(env,context,frame,runtime,cb){var oldGetTemplate=env.getTemplate;env.getTemplate=function(name,ec,cb){if(typeof ec==="function"){cb=ec;ec=false;}
var _require=function(name){try{return require(name);}catch(e){if(frame.get("_require"))return frame.get("_require")(name)}};var tmpl=_require(name);frame.set("_require",_require);if(ec)tmpl.compile();cb(null,tmpl);};oldRoot(env,context,frame,runtime,function(err,res){env.getTemplate=oldGetTemplate;cb(err,res);});};var src={obj:obj,type:"code"};module.exports=new nunjucks.Template(src,env);},{"nunjucks":38}],38:[function(require,module,exports){(function(){var modules={};(function(){'use strict';function extend(cls,name,props){var F=function(){};F.prototype=cls.prototype;var prototype=new F();var fnTest=/xyz/.test(function(){xyz;})?/\bparent\b/:/.*/;props=props||{};for(var k in props){var src=props[k];var parent=prototype[k];if(typeof parent==='function'&&typeof src==='function'&&fnTest.test(src)){prototype[k]=(function(src,parent){return function(){var tmp=this.parent;this.parent=parent;var res=src.apply(this,arguments);this.parent=tmp;return res;};})(src,parent);}
else{prototype[k]=src;}}
prototype.typename=name;var new_cls=function(){if(prototype.init){prototype.init.apply(this,arguments);}};new_cls.prototype=prototype;new_cls.prototype.constructor=new_cls;new_cls.extend=function(name,props){if(typeof name==='object'){props=name;name='anonymous';}
return extend(new_cls,name,props);};return new_cls;}
modules['object']=extend(Object,'Object',{});})();(function(){'use strict';var ArrayProto=Array.prototype;var ObjProto=Object.prototype;var escapeMap={'&':'&amp;','"':'&quot;','\'':'&#39;','<':'&lt;','>':'&gt;'};var escapeRegex=/[&"'<>]/g;var lookupEscape=function(ch){return escapeMap[ch];};var exports=modules['lib']={};exports.withPrettyErrors=function(path,withInternals,func){try{return func();}catch(e){if(!e.Update){e=new exports.TemplateError(e);}
e.Update(path);if(!withInternals){var old=e;e=new Error(old.message);e.name=old.name;}
throw e;}};exports.TemplateError=function(message,lineno,colno){var err=this;if(message instanceof Error){err=message;message=message.name+': '+message.message;}else{if(Error.captureStackTrace){Error.captureStackTrace(err);}}
err.name='Template render error';err.message=message;err.lineno=lineno;err.colno=colno;err.firstUpdate=true;err.Update=function(path){var message='('+(path||'unknown path')+')';if(this.firstUpdate){if(this.lineno&&this.colno){message+=' [Line '+this.lineno+', Column '+this.colno+']';}
else if(this.lineno){message+=' [Line '+this.lineno+']';}}
message+='\n ';if(this.firstUpdate){message+=' ';}
this.message=message+(this.message||'');this.firstUpdate=false;return this;};return err;};exports.TemplateError.prototype=Error.prototype;exports.escape=function(val){return val.replace(escapeRegex,lookupEscape);};exports.isFunction=function(obj){return ObjProto.toString.call(obj)==='[object Function]';};exports.isArray=Array.isArray||function(obj){return ObjProto.toString.call(obj)==='[object Array]';};exports.isString=function(obj){return ObjProto.toString.call(obj)==='[object String]';};exports.isObject=function(obj){return ObjProto.toString.call(obj)==='[object Object]';};exports.groupBy=function(obj,val){var result={};var iterator=exports.isFunction(val)?val:function(obj){return obj[val];};for(var i=0;i<obj.length;i++){var value=obj[i];var key=iterator(value,i);(result[key]||(result[key]=[])).push(value);}
return result;};exports.toArray=function(obj){return Array.prototype.slice.call(obj);};exports.without=function(array){var result=[];if(!array){return result;}
var index=-1,length=array.length,contains=exports.toArray(arguments).slice(1);while(++index<length){if(exports.indexOf(contains,array[index])===-1){result.push(array[index]);}}
return result;};exports.extend=function(obj,obj2){for(var k in obj2){obj[k]=obj2[k];}
return obj;};exports.repeat=function(char_,n){var str='';for(var i=0;i<n;i++){str+=char_;}
return str;};exports.each=function(obj,func,context){if(obj==null){return;}
if(ArrayProto.each&&obj.each===ArrayProto.each){obj.forEach(func,context);}
else if(obj.length===+obj.length){for(var i=0,l=obj.length;i<l;i++){func.call(context,obj[i],i,obj);}}};exports.map=function(obj,func){var results=[];if(obj==null){return results;}
if(ArrayProto.map&&obj.map===ArrayProto.map){return obj.map(func);}
for(var i=0;i<obj.length;i++){results[results.length]=func(obj[i],i);}
if(obj.length===+obj.length){results.length=obj.length;}
return results;};exports.asyncIter=function(arr,iter,cb){var i=-1;function next(){i++;if(i<arr.length){iter(arr[i],i,next,cb);}
else{cb();}}
next();};exports.asyncFor=function(obj,iter,cb){var keys=exports.keys(obj);var len=keys.length;var i=-1;function next(){i++;var k=keys[i];if(i<len){iter(k,obj[k],i,len,next);}
else{cb();}}
next();};exports.indexOf=Array.prototype.indexOf?function(arr,searchElement,fromIndex){return Array.prototype.indexOf.call(arr,searchElement,fromIndex);}:function(arr,searchElement,fromIndex){var length=this.length>>>0;fromIndex=+fromIndex||0;if(Math.abs(fromIndex)===Infinity){fromIndex=0;}
if(fromIndex<0){fromIndex+=length;if(fromIndex<0){fromIndex=0;}}
for(;fromIndex<length;fromIndex++){if(arr[fromIndex]===searchElement){return fromIndex;}}
return-1;};if(!Array.prototype.map){Array.prototype.map=function(){throw new Error('map is unimplemented for this js engine');};}
exports.keys=function(obj){if(Object.prototype.keys){return obj.keys();}
else{var keys=[];for(var k in obj){if(obj.hasOwnProperty(k)){keys.push(k);}}
return keys;}}})();(function(){'use strict';var util=modules["util"];var lib=modules["lib"];var Object=modules["object"];function traverseAndCheck(obj,type,results){if(obj instanceof type){results.push(obj);}
if(obj instanceof Node){obj.findAll(type,results);}}
var Node=Object.extend('Node',{init:function(lineno,colno){this.lineno=lineno;this.colno=colno;var fields=this.fields;for(var i=0,l=fields.length;i<l;i++){var field=fields[i];var val=arguments[i+2];if(val===undefined){val=null;}
this[field]=val;}},findAll:function(type,results){results=results||[];if(this instanceof NodeList){var children=this.children;for(var i=0,l=children.length;i<l;i++){traverseAndCheck(children[i],type,results);}}
else{var fields=this.fields;for(var i=0,l=fields.length;i<l;i++){traverseAndCheck(this[fields[i]],type,results);}}
return results;},iterFields:function(func){lib.each(this.fields,function(field){func(this[field],field);},this);}});var Value=Node.extend('Value',{fields:['value']});var NodeList=Node.extend('NodeList',{fields:['children'],init:function(lineno,colno,nodes){this.parent(lineno,colno,nodes||[]);},addChild:function(node){this.children.push(node);}});var Root=NodeList.extend('Root');var Literal=Value.extend('Literal');var Symbol=Value.extend('Symbol');var Group=NodeList.extend('Group');var Array=NodeList.extend('Array');var Pair=Node.extend('Pair',{fields:['key','value']});var Dict=NodeList.extend('Dict');var LookupVal=Node.extend('LookupVal',{fields:['target','val']});var If=Node.extend('If',{fields:['cond','body','else_']});var IfAsync=If.extend('IfAsync');var InlineIf=Node.extend('InlineIf',{fields:['cond','body','else_']});var For=Node.extend('For',{fields:['arr','name','body','else_']});var AsyncEach=For.extend('AsyncEach');var AsyncAll=For.extend('AsyncAll');var Macro=Node.extend('Macro',{fields:['name','args','body']});var Caller=Macro.extend('Caller');var Import=Node.extend('Import',{fields:['template','target','withContext']});var FromImport=Node.extend('FromImport',{fields:['template','names','withContext'],init:function(lineno,colno,template,names,withContext){this.parent(lineno,colno,template,names||new NodeList(),withContext);}});var FunCall=Node.extend('FunCall',{fields:['name','args']});var Filter=FunCall.extend('Filter');var FilterAsync=Filter.extend('FilterAsync',{fields:['name','args','symbol']});var KeywordArgs=Dict.extend('KeywordArgs');var Block=Node.extend('Block',{fields:['name','body']});var Super=Node.extend('Super',{fields:['blockName','symbol']});var TemplateRef=Node.extend('TemplateRef',{fields:['template']});var Extends=TemplateRef.extend('Extends');var Include=TemplateRef.extend('Include');var Set=Node.extend('Set',{fields:['targets','value']});var Output=NodeList.extend('Output');var TemplateData=Literal.extend('TemplateData');var UnaryOp=Node.extend('UnaryOp',{fields:['target']});var BinOp=Node.extend('BinOp',{fields:['left','right']});var In=BinOp.extend('In');var Or=BinOp.extend('Or');var And=BinOp.extend('And');var Not=UnaryOp.extend('Not');var Add=BinOp.extend('Add');var Sub=BinOp.extend('Sub');var Mul=BinOp.extend('Mul');var Div=BinOp.extend('Div');var FloorDiv=BinOp.extend('FloorDiv');var Mod=BinOp.extend('Mod');var Pow=BinOp.extend('Pow');var Neg=UnaryOp.extend('Neg');var Pos=UnaryOp.extend('Pos');var Compare=Node.extend('Compare',{fields:['expr','ops']});var CompareOperand=Node.extend('CompareOperand',{fields:['expr','type']});var CustomTag=Node.extend('CustomTag',{init:function(lineno,colno,name){this.lineno=lineno;this.colno=colno;this.name=name;}});var CallExtension=Node.extend('CallExtension',{fields:['extName','prop','args','contentArgs'],init:function(ext,prop,args,contentArgs){this.extName=ext._name||ext;this.prop=prop;this.args=args||new NodeList();this.contentArgs=contentArgs||[];this.autoescape=ext.autoescape;}});var CallExtensionAsync=CallExtension.extend('CallExtensionAsync');function printNodes(node,indent){indent=indent||0;function print(str,indent,inline){var lines=str.split('\n');for(var i=0;i<lines.length;i++){if(lines[i]){if((inline&&i>0)||!inline){for(var j=0;j<indent;j++){util.print(' ');}}}
if(i===lines.length-1){util.print(lines[i]);}
else{util.puts(lines[i]);}}}
print(node.typename+': ',indent);if(node instanceof NodeList){print('\n');lib.each(node.children,function(n){printNodes(n,indent+2);});}
else if(node instanceof CallExtension){print(node.extName+'.'+node.prop);print('\n');if(node.args){printNodes(node.args,indent+2);}
if(node.contentArgs){lib.each(node.contentArgs,function(n){printNodes(n,indent+2);});}}
else{var nodes=null;var props=null;node.iterFields(function(val,field){if(val instanceof Node){nodes=nodes||{};nodes[field]=val;}
else{props=props||{};props[field]=val;}});if(props){print(util.inspect(props,true,null)+'\n',null,true);}
else{print('\n');}
if(nodes){for(var k in nodes){printNodes(nodes[k],indent+2);}}}}
modules['nodes']={Node:Node,Root:Root,NodeList:NodeList,Value:Value,Literal:Literal,Symbol:Symbol,Group:Group,Array:Array,Pair:Pair,Dict:Dict,Output:Output,TemplateData:TemplateData,If:If,IfAsync:IfAsync,InlineIf:InlineIf,For:For,AsyncEach:AsyncEach,AsyncAll:AsyncAll,Macro:Macro,Caller:Caller,Import:Import,FromImport:FromImport,FunCall:FunCall,Filter:Filter,FilterAsync:FilterAsync,KeywordArgs:KeywordArgs,Block:Block,Super:Super,Extends:Extends,Include:Include,Set:Set,LookupVal:LookupVal,BinOp:BinOp,In:In,Or:Or,And:And,Not:Not,Add:Add,Sub:Sub,Mul:Mul,Div:Div,FloorDiv:FloorDiv,Mod:Mod,Pow:Pow,Neg:Neg,Pos:Pos,Compare:Compare,CompareOperand:CompareOperand,CallExtension:CallExtension,CallExtensionAsync:CallExtensionAsync,printNodes:printNodes};})();(function(){'use strict';var lib=modules["lib"];var Obj=modules["object"];var Frame=Obj.extend({init:function(parent){this.variables={};this.parent=parent;},set:function(name,val,resolveUp){var parts=name.split('.');var obj=this.variables;var frame=this;if(resolveUp){if((frame=this.resolve(parts[0]))){frame.set(name,val);return;}
frame=this;}
for(var i=0;i<parts.length-1;i++){var id=parts[i];if(!obj[id]){obj[id]={};}
obj=obj[id];}
obj[parts[parts.length-1]]=val;},get:function(name){var val=this.variables[name];if(val!==undefined&&val!==null){return val;}
return null;},lookup:function(name){var p=this.parent;var val=this.variables[name];if(val!==undefined&&val!==null){return val;}
return p&&p.lookup(name);},resolve:function(name){var p=this.parent;var val=this.variables[name];if(val!==undefined&&val!==null){return this;}
return p&&p.resolve(name);},push:function(){return new Frame(this);},pop:function(){return this.parent;}});function makeMacro(argNames,kwargNames,func){return function(){var argCount=numArgs(arguments);var args;var kwargs=getKeywordArgs(arguments);if(argCount>argNames.length){args=Array.prototype.slice.call(arguments,0,argNames.length);var vals=Array.prototype.slice.call(arguments,args.length,argCount);for(var i=0;i<vals.length;i++){if(i<kwargNames.length){kwargs[kwargNames[i]]=vals[i];}}
args.push(kwargs);}
else if(argCount<argNames.length){args=Array.prototype.slice.call(arguments,0,argCount);for(var i=argCount;i<argNames.length;i++){var arg=argNames[i];args.push(kwargs[arg]);delete kwargs[arg];}
args.push(kwargs);}
else{args=arguments;}
return func.apply(this,args);};}
function makeKeywordArgs(obj){obj.__keywords=true;return obj;}
function getKeywordArgs(args){var len=args.length;if(len){var lastArg=args[len-1];if(lastArg&&lastArg.hasOwnProperty('__keywords')){return lastArg;}}
return{};}
function numArgs(args){var len=args.length;if(len===0){return 0;}
var lastArg=args[len-1];if(lastArg&&lastArg.hasOwnProperty('__keywords')){return len-1;}
else{return len;}}
function SafeString(val){if(typeof val!=='string'){return val;}
this.val=val;}
SafeString.prototype=Object.create(String.prototype);SafeString.prototype.valueOf=function(){return this.val;};SafeString.prototype.toString=function(){return this.val;};function copySafeness(dest,target){if(dest instanceof SafeString){return new SafeString(target);}
return target.toString();}
function markSafe(val){var type=typeof val;if(type==='string'){return new SafeString(val);}
else if(type!=='function'){return val;}
else{return function(){var ret=val.apply(this,arguments);if(typeof ret==='string'){return new SafeString(ret);}
return ret;};}}
function suppressValue(val,autoescape){val=(val!==undefined&&val!==null)?val:'';if(autoescape&&typeof val==='string'){val=lib.escape(val);}
return val;}
function memberLookup(obj,val){obj=obj||{};if(typeof obj[val]==='function'){return function(){return obj[val].apply(obj,arguments);};}
return obj[val];}
function callWrap(obj,name,args){if(!obj){throw new Error('Unable to call `'+name+'`, which is undefined or falsey');}
else if(typeof obj!=='function'){throw new Error('Unable to call `'+name+'`, which is not a function');}
return obj.apply(this,args);}
function contextOrFrameLookup(context,frame,name){var val=frame.lookup(name);return(val!==undefined&&val!==null)?val:context.lookup(name);}
function handleError(error,lineno,colno){if(error.lineno){return error;}
else{return new lib.TemplateError(error,lineno,colno);}}
function asyncEach(arr,dimen,iter,cb){if(lib.isArray(arr)){var len=arr.length;lib.asyncIter(arr,function(item,i,next){switch(dimen){case 1:iter(item,i,len,next);break;case 2:iter(item[0],item[1],i,len,next);break;case 3:iter(item[0],item[1],item[2],i,len,next);break;default:item.push(i,next);iter.apply(this,item);}},cb);}
else{lib.asyncFor(arr,function(key,val,i,len,next){iter(key,val,i,len,next);},cb);}}
function asyncAll(arr,dimen,func,cb){var finished=0;var len;var outputArr;function done(i,output){finished++;outputArr[i]=output;if(finished===len){cb(null,outputArr.join(''));}}
if(lib.isArray(arr)){len=arr.length;outputArr=new Array(len);if(len===0){cb(null,'');}
else{for(var i=0;i<arr.length;i++){var item=arr[i];switch(dimen){case 1:func(item,i,len,done);break;case 2:func(item[0],item[1],i,len,done);break;case 3:func(item[0],item[1],item[2],i,len,done);break;default:item.push(i,done);func.apply(this,item);}}}}
else{var keys=lib.keys(arr);len=keys.length;outputArr=new Array(len);if(len===0){cb(null,'');}
else{for(var i=0;i<keys.length;i++){var k=keys[i];func(k,arr[k],i,len,done);}}}}
modules['runtime']={Frame:Frame,makeMacro:makeMacro,makeKeywordArgs:makeKeywordArgs,numArgs:numArgs,suppressValue:suppressValue,memberLookup:memberLookup,contextOrFrameLookup:contextOrFrameLookup,callWrap:callWrap,handleError:handleError,isArray:lib.isArray,keys:lib.keys,SafeString:SafeString,copySafeness:copySafeness,markSafe:markSafe,asyncEach:asyncEach,asyncAll:asyncAll};})();(function(){'use strict';var lib=modules["lib"];var whitespaceChars=' \n\t\r\u00A0';var delimChars='()[]{}%*-+/#,:|.<>=!';var intChars='0123456789';var BLOCK_START='{%';var BLOCK_END='%}';var VARIABLE_START='{{';var VARIABLE_END='}}';var COMMENT_START='{#';var COMMENT_END='#}';var TOKEN_STRING='string';var TOKEN_WHITESPACE='whitespace';var TOKEN_DATA='data';var TOKEN_BLOCK_START='block-start';var TOKEN_BLOCK_END='block-end';var TOKEN_VARIABLE_START='variable-start';var TOKEN_VARIABLE_END='variable-end';var TOKEN_COMMENT='comment';var TOKEN_LEFT_PAREN='left-paren';var TOKEN_RIGHT_PAREN='right-paren';var TOKEN_LEFT_BRACKET='left-bracket';var TOKEN_RIGHT_BRACKET='right-bracket';var TOKEN_LEFT_CURLY='left-curly';var TOKEN_RIGHT_CURLY='right-curly';var TOKEN_OPERATOR='operator';var TOKEN_COMMA='comma';var TOKEN_COLON='colon';var TOKEN_PIPE='pipe';var TOKEN_INT='int';var TOKEN_FLOAT='float';var TOKEN_BOOLEAN='boolean';var TOKEN_SYMBOL='symbol';var TOKEN_SPECIAL='special';var TOKEN_REGEX='regex';function token(type,value,lineno,colno){return{type:type,value:value,lineno:lineno,colno:colno};}
function Tokenizer(str,opts){this.str=str;this.index=0;this.len=str.length;this.lineno=0;this.colno=0;this.in_code=false;opts=opts||{};var tags=opts.tags||{};this.tags={BLOCK_START:tags.blockStart||BLOCK_START,BLOCK_END:tags.blockEnd||BLOCK_END,VARIABLE_START:tags.variableStart||VARIABLE_START,VARIABLE_END:tags.variableEnd||VARIABLE_END,COMMENT_START:tags.commentStart||COMMENT_START,COMMENT_END:tags.commentEnd||COMMENT_END};this.trimBlocks=!!opts.trimBlocks;this.lstripBlocks=!!opts.lstripBlocks;}
Tokenizer.prototype.nextToken=function(){var lineno=this.lineno;var colno=this.colno;var tok;if(this.in_code){var cur=this.current();if(this.is_finished()){return null;}
else if(cur==='"'||cur==='\''){return token(TOKEN_STRING,this.parseString(cur),lineno,colno);}
else if((tok=this._extract(whitespaceChars))){return token(TOKEN_WHITESPACE,tok,lineno,colno);}
else if((tok=this._extractString(this.tags.BLOCK_END))||(tok=this._extractString('-'+this.tags.BLOCK_END))){this.in_code=false;if(this.trimBlocks){cur=this.current();if(cur==='\n'){this.forward();}}
return token(TOKEN_BLOCK_END,tok,lineno,colno);}
else if((tok=this._extractString(this.tags.VARIABLE_END))){this.in_code=false;return token(TOKEN_VARIABLE_END,tok,lineno,colno);}
else if(cur==='r'&&this.str.charAt(this.index+1)==='/'){this.forwardN(2);var regexBody='';while(!this.is_finished()){if(this.current()==='/'&&this.previous()!=='\\'){this.forward();break;}else{regexBody+=this.current();this.forward();}}
var POSSIBLE_FLAGS=['g','i','m','y'];var regexFlags='';while(!this.is_finished()){var isCurrentAFlag=POSSIBLE_FLAGS.indexOf(this.current())!==-1;if(isCurrentAFlag){regexFlags+=this.current();this.forward();}else{break;}}
return token(TOKEN_REGEX,{body:regexBody,flags:regexFlags},lineno,colno);}
else if(delimChars.indexOf(cur)!==-1){this.forward();var complexOps=['==','!=','<=','>=','//','**'];var curComplex=cur+this.current();var type;if(lib.indexOf(complexOps,curComplex)!==-1){this.forward();cur=curComplex;}
switch(cur){case '(':type=TOKEN_LEFT_PAREN;break;case ')':type=TOKEN_RIGHT_PAREN;break;case '[':type=TOKEN_LEFT_BRACKET;break;case ']':type=TOKEN_RIGHT_BRACKET;break;case '{':type=TOKEN_LEFT_CURLY;break;case '}':type=TOKEN_RIGHT_CURLY;break;case ',':type=TOKEN_COMMA;break;case ':':type=TOKEN_COLON;break;case '|':type=TOKEN_PIPE;break;default:type=TOKEN_OPERATOR;}
return token(type,cur,lineno,colno);}
else{tok=this._extractUntil(whitespaceChars+delimChars);if(tok.match(/^[-+]?[0-9]+$/)){if(this.current()==='.'){this.forward();var dec=this._extract(intChars);return token(TOKEN_FLOAT,tok+'.'+dec,lineno,colno);}
else{return token(TOKEN_INT,tok,lineno,colno);}}
else if(tok.match(/^(true|false)$/)){return token(TOKEN_BOOLEAN,tok,lineno,colno);}
else if(tok){return token(TOKEN_SYMBOL,tok,lineno,colno);}
else{throw new Error('Unexpected value while parsing: '+tok);}}}
else{var beginChars=(this.tags.BLOCK_START.charAt(0)+
this.tags.VARIABLE_START.charAt(0)+
this.tags.COMMENT_START.charAt(0)+
this.tags.COMMENT_END.charAt(0));if(this.is_finished()){return null;}
else if((tok=this._extractString(this.tags.BLOCK_START+'-'))||(tok=this._extractString(this.tags.BLOCK_START))){this.in_code=true;return token(TOKEN_BLOCK_START,tok,lineno,colno);}
else if((tok=this._extractString(this.tags.VARIABLE_START))){this.in_code=true;return token(TOKEN_VARIABLE_START,tok,lineno,colno);}
else{tok='';var data;var in_comment=false;if(this._matches(this.tags.COMMENT_START)){in_comment=true;tok=this._extractString(this.tags.COMMENT_START);}
while((data=this._extractUntil(beginChars))!==null){tok+=data;if((this._matches(this.tags.BLOCK_START)||this._matches(this.tags.VARIABLE_START)||this._matches(this.tags.COMMENT_START))&&!in_comment){if(this.lstripBlocks&&this._matches(this.tags.BLOCK_START)&&this.colno>0&&this.colno<=tok.length){var lastLine=tok.slice(-this.colno);if(/^\s+$/.test(lastLine)){tok=tok.slice(0,-this.colno);if(!tok.length){return this.nextToken();}}}
break;}
else if(this._matches(this.tags.COMMENT_END)){if(!in_comment){throw new Error('unexpected end of comment');}
tok+=this._extractString(this.tags.COMMENT_END);break;}
else{tok+=this.current();this.forward();}}
if(data===null&&in_comment){throw new Error('expected end of comment, got end of file');}
return token(in_comment?TOKEN_COMMENT:TOKEN_DATA,tok,lineno,colno);}}
throw new Error('Could not parse text');};Tokenizer.prototype.parseString=function(delimiter){this.forward();var lineno=this.lineno;var colno=this.colno;var str='';while(!this.is_finished()&&this.current()!==delimiter){var cur=this.current();if(cur==='\\'){this.forward();switch(this.current()){case 'n':str+='\n';break;case 't':str+='\t';break;case 'r':str+='\r';break;default:str+=this.current();}
this.forward();}
else{str+=cur;this.forward();}}
this.forward();return str;};Tokenizer.prototype._matches=function(str){if(this.index+str.length>this.len){return null;}
var m=this.str.slice(this.index,this.index+str.length);return m===str;};Tokenizer.prototype._extractString=function(str){if(this._matches(str)){this.index+=str.length;return str;}
return null;};Tokenizer.prototype._extractUntil=function(charString){return this._extractMatching(true,charString||'');};Tokenizer.prototype._extract=function(charString){return this._extractMatching(false,charString);};Tokenizer.prototype._extractMatching=function(breakOnMatch,charString){if(this.is_finished()){return null;}
var first=charString.indexOf(this.current());if((breakOnMatch&&first===-1)||(!breakOnMatch&&first!==-1)){var t=this.current();this.forward();var idx=charString.indexOf(this.current());while(((breakOnMatch&&idx===-1)||(!breakOnMatch&&idx!==-1))&&!this.is_finished()){t+=this.current();this.forward();idx=charString.indexOf(this.current());}
return t;}
return '';};Tokenizer.prototype.is_finished=function(){return this.index>=this.len;};Tokenizer.prototype.forwardN=function(n){for(var i=0;i<n;i++){this.forward();}};Tokenizer.prototype.forward=function(){this.index++;if(this.previous()==='\n'){this.lineno++;this.colno=0;}
else{this.colno++;}};Tokenizer.prototype.back=function(){this.index--;if(this.current()==='\n'){this.lineno--;var idx=this.src.lastIndexOf('\n',this.index-1);if(idx===-1){this.colno=this.index;}
else{this.colno=this.index-idx;}}
else{this.colno--;}};Tokenizer.prototype.current=function(){if(!this.is_finished()){return this.str.charAt(this.index);}
return '';};Tokenizer.prototype.previous=function(){return this.str.charAt(this.index-1);};modules['lexer']={lex:function(src,opts){return new Tokenizer(src,opts);},TOKEN_STRING:TOKEN_STRING,TOKEN_WHITESPACE:TOKEN_WHITESPACE,TOKEN_DATA:TOKEN_DATA,TOKEN_BLOCK_START:TOKEN_BLOCK_START,TOKEN_BLOCK_END:TOKEN_BLOCK_END,TOKEN_VARIABLE_START:TOKEN_VARIABLE_START,TOKEN_VARIABLE_END:TOKEN_VARIABLE_END,TOKEN_COMMENT:TOKEN_COMMENT,TOKEN_LEFT_PAREN:TOKEN_LEFT_PAREN,TOKEN_RIGHT_PAREN:TOKEN_RIGHT_PAREN,TOKEN_LEFT_BRACKET:TOKEN_LEFT_BRACKET,TOKEN_RIGHT_BRACKET:TOKEN_RIGHT_BRACKET,TOKEN_LEFT_CURLY:TOKEN_LEFT_CURLY,TOKEN_RIGHT_CURLY:TOKEN_RIGHT_CURLY,TOKEN_OPERATOR:TOKEN_OPERATOR,TOKEN_COMMA:TOKEN_COMMA,TOKEN_COLON:TOKEN_COLON,TOKEN_PIPE:TOKEN_PIPE,TOKEN_INT:TOKEN_INT,TOKEN_FLOAT:TOKEN_FLOAT,TOKEN_BOOLEAN:TOKEN_BOOLEAN,TOKEN_SYMBOL:TOKEN_SYMBOL,TOKEN_SPECIAL:TOKEN_SPECIAL,TOKEN_REGEX:TOKEN_REGEX};})();(function(){'use strict';var lexer=modules["lexer"];var nodes=modules["nodes"];var Object=modules["object"];var lib=modules["lib"];var Parser=Object.extend({init:function(tokens){this.tokens=tokens;this.peeked=null;this.breakOnBlocks=null;this.dropLeadingWhitespace=false;this.extensions=[];},nextToken:function(withWhitespace){var tok;if(this.peeked){if(!withWhitespace&&this.peeked.type===lexer.TOKEN_WHITESPACE){this.peeked=null;}
else{tok=this.peeked;this.peeked=null;return tok;}}
tok=this.tokens.nextToken();if(!withWhitespace){while(tok&&tok.type===lexer.TOKEN_WHITESPACE){tok=this.tokens.nextToken();}}
return tok;},peekToken:function(){this.peeked=this.peeked||this.nextToken();return this.peeked;},pushToken:function(tok){if(this.peeked){throw new Error('pushToken: can only push one token on between reads');}
this.peeked=tok;},fail:function(msg,lineno,colno){if((lineno===undefined||colno===undefined)&&this.peekToken()){var tok=this.peekToken();lineno=tok.lineno;colno=tok.colno;}
if(lineno!==undefined)lineno+=1;if(colno!==undefined)colno+=1;throw new lib.TemplateError(msg,lineno,colno);},skip:function(type){var tok=this.nextToken();if(!tok||tok.type!==type){this.pushToken(tok);return false;}
return true;},expect:function(type){var tok=this.nextToken();if(tok.type!==type){this.fail('expected '+type+', got '+tok.type,tok.lineno,tok.colno);}
return tok;},skipValue:function(type,val){var tok=this.nextToken();if(!tok||tok.type!==type||tok.value!==val){this.pushToken(tok);return false;}
return true;},skipWhitespace:function(){return this.skip(lexer.TOKEN_WHITESPACE);},skipSymbol:function(val){return this.skipValue(lexer.TOKEN_SYMBOL,val);},advanceAfterBlockEnd:function(name){if(!name){var tok=this.peekToken();if(!tok){this.fail('unexpected end of file');}
if(tok.type!==lexer.TOKEN_SYMBOL){this.fail('advanceAfterBlockEnd: expected symbol token or '+
'explicit name to be passed');}
name=this.nextToken().value;}
var tok=this.nextToken();if(tok&&tok.type===lexer.TOKEN_BLOCK_END){if(tok.value.charAt(0)==='-'){this.dropLeadingWhitespace=true;}}
else{this.fail('expected block end in '+name+' statement');}},advanceAfterVariableEnd:function(){if(!this.skip(lexer.TOKEN_VARIABLE_END)){this.fail('expected variable end');}},parseFor:function(){var forTok=this.peekToken();var node;var endBlock;if(this.skipSymbol('for')){node=new nodes.For(forTok.lineno,forTok.colno);endBlock='endfor';}
else if(this.skipSymbol('asyncEach')){node=new nodes.AsyncEach(forTok.lineno,forTok.colno);endBlock='endeach';}
else if(this.skipSymbol('asyncAll')){node=new nodes.AsyncAll(forTok.lineno,forTok.colno);endBlock='endall';}
else{this.fail('parseFor: expected for{Async}',forTok.lineno,forTok.colno);}
node.name=this.parsePrimary();if(!(node.name instanceof nodes.Symbol)){this.fail('parseFor: variable name expected for loop');}
var type=this.peekToken().type;if(type===lexer.TOKEN_COMMA){var key=node.name;node.name=new nodes.Array(key.lineno,key.colno);node.name.addChild(key);while(this.skip(lexer.TOKEN_COMMA)){var prim=this.parsePrimary();node.name.addChild(prim);}}
if(!this.skipSymbol('in')){this.fail('parseFor: expected "in" keyword for loop',forTok.lineno,forTok.colno);}
node.arr=this.parseExpression();this.advanceAfterBlockEnd(forTok.value);node.body=this.parseUntilBlocks(endBlock,'else');if(this.skipSymbol('else')){this.advanceAfterBlockEnd('else');node.else_=this.parseUntilBlocks(endBlock);}
this.advanceAfterBlockEnd();return node;},parseMacro:function(){var macroTok=this.peekToken();if(!this.skipSymbol('macro')){this.fail('expected macro');}
var name=this.parsePrimary(true);var args=this.parseSignature();var node=new nodes.Macro(macroTok.lineno,macroTok.colno,name,args);this.advanceAfterBlockEnd(macroTok.value);node.body=this.parseUntilBlocks('endmacro');this.advanceAfterBlockEnd();return node;},parseCall:function(){var callTok=this.peekToken();if(!this.skipSymbol('call')){this.fail('expected call');}
var callerArgs=this.parseSignature(true)||new nodes.NodeList();var macroCall=this.parsePrimary();this.advanceAfterBlockEnd(callTok.value);var body=this.parseUntilBlocks('endcall');this.advanceAfterBlockEnd();var callerName=new nodes.Symbol(callTok.lineno,callTok.colno,'caller');var callerNode=new nodes.Caller(callTok.lineno,callTok.colno,callerName,callerArgs,body);var args=macroCall.args.children;if(!(args[args.length-1]instanceof nodes.KeywordArgs)){args.push(new nodes.KeywordArgs());}
var kwargs=args[args.length-1];kwargs.addChild(new nodes.Pair(callTok.lineno,callTok.colno,callerName,callerNode));return new nodes.Output(callTok.lineno,callTok.colno,[macroCall]);},parseWithContext:function(){var tok=this.peekToken();var withContext=null;if(this.skipSymbol('with')){withContext=true;}
else if(this.skipSymbol('without')){withContext=false;}
if(withContext!==null){if(!this.skipSymbol('context')){this.fail('parseFrom: expected context after with/without',tok.lineno,tok.colno);}}
return withContext;},parseImport:function(){var importTok=this.peekToken();if(!this.skipSymbol('import')){this.fail('parseImport: expected import',importTok.lineno,importTok.colno);}
var template=this.parseExpression();if(!this.skipSymbol('as')){this.fail('parseImport: expected "as" keyword',importTok.lineno,importTok.colno);}
var target=this.parsePrimary();var withContext=this.parseWithContext();var node=new nodes.Import(importTok.lineno,importTok.colno,template,target,withContext);this.advanceAfterBlockEnd(importTok.value);return node;},parseFrom:function(){var fromTok=this.peekToken();if(!this.skipSymbol('from')){this.fail('parseFrom: expected from');}
var template=this.parsePrimary();if(!this.skipSymbol('import')){this.fail('parseFrom: expected import',fromTok.lineno,fromTok.colno);}
var names=new nodes.NodeList(),withContext;while(1){var nextTok=this.peekToken();if(nextTok.type===lexer.TOKEN_BLOCK_END){if(!names.children.length){this.fail('parseFrom: Expected at least one import name',fromTok.lineno,fromTok.colno);}
if(nextTok.value.charAt(0)==='-'){this.dropLeadingWhitespace=true;}
this.nextToken();break;}
if(names.children.length>0&&!this.skip(lexer.TOKEN_COMMA)){this.fail('parseFrom: expected comma',fromTok.lineno,fromTok.colno);}
var name=this.parsePrimary();if(name.value.charAt(0)==='_'){this.fail('parseFrom: names starting with an underscore '+
'cannot be imported',name.lineno,name.colno);}
if(this.skipSymbol('as')){var alias=this.parsePrimary();names.addChild(new nodes.Pair(name.lineno,name.colno,name,alias));}
else{names.addChild(name);}
withContext=this.parseWithContext();}
return new nodes.FromImport(fromTok.lineno,fromTok.colno,template,names,withContext);},parseBlock:function(){var tag=this.peekToken();if(!this.skipSymbol('block')){this.fail('parseBlock: expected block',tag.lineno,tag.colno);}
var node=new nodes.Block(tag.lineno,tag.colno);node.name=this.parsePrimary();if(!(node.name instanceof nodes.Symbol)){this.fail('parseBlock: variable name expected',tag.lineno,tag.colno);}
this.advanceAfterBlockEnd(tag.value);node.body=this.parseUntilBlocks('endblock');if(!this.peekToken()){this.fail('parseBlock: expected endblock, got end of file');}
this.advanceAfterBlockEnd();return node;},parseTemplateRef:function(tagName,nodeType){var tag=this.peekToken();if(!this.skipSymbol(tagName)){this.fail('parseTemplateRef: expected '+tagName);}
var node=new nodeType(tag.lineno,tag.colno);node.template=this.parseExpression();this.advanceAfterBlockEnd(tag.value);return node;},parseExtends:function(){return this.parseTemplateRef('extends',nodes.Extends);},parseInclude:function(){return this.parseTemplateRef('include',nodes.Include);},parseIf:function(){var tag=this.peekToken();var node;if(this.skipSymbol('if')||this.skipSymbol('elif')){node=new nodes.If(tag.lineno,tag.colno);}
else if(this.skipSymbol('ifAsync')){node=new nodes.IfAsync(tag.lineno,tag.colno);}
else{this.fail('parseIf: expected if or elif',tag.lineno,tag.colno);}
node.cond=this.parseExpression();this.advanceAfterBlockEnd(tag.value);node.body=this.parseUntilBlocks('elif','else','endif');var tok=this.peekToken();switch(tok&&tok.value){case 'elif':node.else_=this.parseIf();break;case 'else':this.advanceAfterBlockEnd();node.else_=this.parseUntilBlocks('endif');this.advanceAfterBlockEnd();break;case 'endif':node.else_=null;this.advanceAfterBlockEnd();break;default:this.fail('parseIf: expected endif, else, or endif, '+
'got end of file');}
return node;},parseSet:function(){var tag=this.peekToken();if(!this.skipSymbol('set')){this.fail('parseSet: expected set',tag.lineno,tag.colno);}
var node=new nodes.Set(tag.lineno,tag.colno,[]);var target;while((target=this.parsePrimary())){node.targets.push(target);if(!this.skip(lexer.TOKEN_COMMA)){break;}}
if(!this.skipValue(lexer.TOKEN_OPERATOR,'=')){this.fail('parseSet: expected = in set tag',tag.lineno,tag.colno);}
node.value=this.parseExpression();this.advanceAfterBlockEnd(tag.value);return node;},parseStatement:function(){var tok=this.peekToken();var node;if(tok.type!==lexer.TOKEN_SYMBOL){this.fail('tag name expected',tok.lineno,tok.colno);}
if(this.breakOnBlocks&&lib.indexOf(this.breakOnBlocks,tok.value)!==-1){return null;}
switch(tok.value){case 'raw':return this.parseRaw();case 'if':case 'ifAsync':return this.parseIf();case 'for':case 'asyncEach':case 'asyncAll':return this.parseFor();case 'block':return this.parseBlock();case 'extends':return this.parseExtends();case 'include':return this.parseInclude();case 'set':return this.parseSet();case 'macro':return this.parseMacro();case 'call':return this.parseCall();case 'import':return this.parseImport();case 'from':return this.parseFrom();default:if(this.extensions.length){for(var i=0;i<this.extensions.length;i++){var ext=this.extensions[i];if(lib.indexOf(ext.tags||[],tok.value)!==-1){return ext.parse(this,nodes,lexer);}}}
this.fail('unknown block tag: '+tok.value,tok.lineno,tok.colno);}
return node;},parseRaw:function(){this.advanceAfterBlockEnd();var str='';var begun=this.peekToken();while(1){var tok=this.nextToken(true);if(!tok){this.fail('expected endraw, got end of file');}
if(tok.type===lexer.TOKEN_BLOCK_START){var ws=null;var name=this.nextToken(true);if(name.type===lexer.TOKEN_WHITESPACE){ws=name;name=this.nextToken();}
if(name.type===lexer.TOKEN_SYMBOL&&name.value==='endraw'){this.advanceAfterBlockEnd(name.value);break;}
else{str+=tok.value;if(ws){str+=ws.value;}
str+=name.value;}}
else if(tok.type===lexer.TOKEN_STRING){str+='"'+tok.value+'"';}
else{str+=tok.value;}}
var output=new nodes.Output(begun.lineno,begun.colno,[new nodes.TemplateData(begun.lineno,begun.colno,str)]);return output;},parsePostfix:function(node){var tok=this.peekToken();while(tok){if(tok.type===lexer.TOKEN_LEFT_PAREN){node=new nodes.FunCall(tok.lineno,tok.colno,node,this.parseSignature());}
else if(tok.type===lexer.TOKEN_LEFT_BRACKET){var lookup=this.parseAggregate();if(lookup.children.length>1){this.fail('invalid index');}
node=new nodes.LookupVal(tok.lineno,tok.colno,node,lookup.children[0]);}
else if(tok.type===lexer.TOKEN_OPERATOR&&tok.value==='.'){this.nextToken();var val=this.nextToken();if(val.type!==lexer.TOKEN_SYMBOL){this.fail('expected name as lookup value, got '+val.value,val.lineno,val.colno);}
var lookup=new nodes.Literal(val.lineno,val.colno,val.value);node=new nodes.LookupVal(tok.lineno,tok.colno,node,lookup);}
else{break;}
tok=this.peekToken();}
return node;},parseExpression:function(){var node=this.parseInlineIf();return node;},parseInlineIf:function(){var node=this.parseOr();if(this.skipSymbol('if')){var cond_node=this.parseOr();var body_node=node;node=new nodes.InlineIf(node.lineno,node.colno);node.body=body_node;node.cond=cond_node;if(this.skipSymbol('else')){node.else_=this.parseOr();}else{node.else_=null;}}
return node;},parseOr:function(){var node=this.parseAnd();while(this.skipSymbol('or')){var node2=this.parseAnd();node=new nodes.Or(node.lineno,node.colno,node,node2);}
return node;},parseAnd:function(){var node=this.parseNot();while(this.skipSymbol('and')){var node2=this.parseNot();node=new nodes.And(node.lineno,node.colno,node,node2);}
return node;},parseNot:function(){var tok=this.peekToken();if(this.skipSymbol('not')){return new nodes.Not(tok.lineno,tok.colno,this.parseNot());}
return this.parseIn();},parseIn:function(){var node=this.parseCompare();while(1){var tok=this.nextToken();if(!tok){break;}
var invert=tok.type===lexer.TOKEN_SYMBOL&&tok.value==='not';if(!invert){this.pushToken(tok);}
if(this.skipSymbol('in')){var node2=this.parseCompare();node=new nodes.In(node.lineno,node.colno,node,node2);if(invert){node=new nodes.Not(node.lineno,node.colno,node);}}
else{if(invert){this.pushToken(tok);}
break;}}
return node;},parseCompare:function(){var compareOps=['==','!=','<','>','<=','>='];var expr=this.parseAdd();var ops=[];while(1){var tok=this.nextToken();if(!tok){break;}
else if(lib.indexOf(compareOps,tok.value)!==-1){ops.push(new nodes.CompareOperand(tok.lineno,tok.colno,this.parseAdd(),tok.value));}
else{this.pushToken(tok);break;}}
if(ops.length){return new nodes.Compare(ops[0].lineno,ops[0].colno,expr,ops);}
else{return expr;}},parseAdd:function(){var node=this.parseSub();while(this.skipValue(lexer.TOKEN_OPERATOR,'+')){var node2=this.parseSub();node=new nodes.Add(node.lineno,node.colno,node,node2);}
return node;},parseSub:function(){var node=this.parseMul();while(this.skipValue(lexer.TOKEN_OPERATOR,'-')){var node2=this.parseMul();node=new nodes.Sub(node.lineno,node.colno,node,node2);}
return node;},parseMul:function(){var node=this.parseDiv();while(this.skipValue(lexer.TOKEN_OPERATOR,'*')){var node2=this.parseDiv();node=new nodes.Mul(node.lineno,node.colno,node,node2);}
return node;},parseDiv:function(){var node=this.parseFloorDiv();while(this.skipValue(lexer.TOKEN_OPERATOR,'/')){var node2=this.parseFloorDiv();node=new nodes.Div(node.lineno,node.colno,node,node2);}
return node;},parseFloorDiv:function(){var node=this.parseMod();while(this.skipValue(lexer.TOKEN_OPERATOR,'//')){var node2=this.parseMod();node=new nodes.FloorDiv(node.lineno,node.colno,node,node2);}
return node;},parseMod:function(){var node=this.parsePow();while(this.skipValue(lexer.TOKEN_OPERATOR,'%')){var node2=this.parsePow();node=new nodes.Mod(node.lineno,node.colno,node,node2);}
return node;},parsePow:function(){var node=this.parseUnary();while(this.skipValue(lexer.TOKEN_OPERATOR,'**')){var node2=this.parseUnary();node=new nodes.Pow(node.lineno,node.colno,node,node2);}
return node;},parseUnary:function(noFilters){var tok=this.peekToken();var node;if(this.skipValue(lexer.TOKEN_OPERATOR,'-')){node=new nodes.Neg(tok.lineno,tok.colno,this.parseUnary(true));}
else if(this.skipValue(lexer.TOKEN_OPERATOR,'+')){node=new nodes.Pos(tok.lineno,tok.colno,this.parseUnary(true));}
else{node=this.parsePrimary();}
if(!noFilters){node=this.parseFilter(node);}
return node;},parsePrimary:function(noPostfix){var tok=this.nextToken();var val=null;var node=null;if(!tok){this.fail('expected expression, got end of file');}
else if(tok.type===lexer.TOKEN_STRING){val=tok.value;}
else if(tok.type===lexer.TOKEN_INT){val=parseInt(tok.value,10);}
else if(tok.type===lexer.TOKEN_FLOAT){val=parseFloat(tok.value);}
else if(tok.type===lexer.TOKEN_BOOLEAN){if(tok.value==='true'){val=true;}
else if(tok.value==='false'){val=false;}
else{this.fail('invalid boolean: '+tok.value,tok.lineno,tok.colno);}}
else if(tok.type===lexer.TOKEN_REGEX){val=new RegExp(tok.value.body,tok.value.flags);}
if(val!==null){node=new nodes.Literal(tok.lineno,tok.colno,val);}
else if(tok.type===lexer.TOKEN_SYMBOL){node=new nodes.Symbol(tok.lineno,tok.colno,tok.value);if(!noPostfix){node=this.parsePostfix(node);}}
else{this.pushToken(tok);node=this.parseAggregate();}
if(node){return node;}
else{this.fail('unexpected token: '+tok.value,tok.lineno,tok.colno);}},parseFilter:function(node){while(this.skip(lexer.TOKEN_PIPE)){var tok=this.expect(lexer.TOKEN_SYMBOL);var name=tok.value;while(this.skipValue(lexer.TOKEN_OPERATOR,'.')){name+='.'+this.expect(lexer.TOKEN_SYMBOL).value;}
node=new nodes.Filter(tok.lineno,tok.colno,new nodes.Symbol(tok.lineno,tok.colno,name),new nodes.NodeList(tok.lineno,tok.colno,[node]));if(this.peekToken().type===lexer.TOKEN_LEFT_PAREN){var call=this.parsePostfix(node);node.args.children=node.args.children.concat(call.args.children);}}
return node;},parseAggregate:function(){var tok=this.nextToken();var node;switch(tok.type){case lexer.TOKEN_LEFT_PAREN:node=new nodes.Group(tok.lineno,tok.colno);break;case lexer.TOKEN_LEFT_BRACKET:node=new nodes.Array(tok.lineno,tok.colno);break;case lexer.TOKEN_LEFT_CURLY:node=new nodes.Dict(tok.lineno,tok.colno);break;default:return null;}
while(1){var type=this.peekToken().type;if(type===lexer.TOKEN_RIGHT_PAREN||type===lexer.TOKEN_RIGHT_BRACKET||type===lexer.TOKEN_RIGHT_CURLY){this.nextToken();break;}
if(node.children.length>0){if(!this.skip(lexer.TOKEN_COMMA)){this.fail('parseAggregate: expected comma after expression',tok.lineno,tok.colno);}}
if(node instanceof nodes.Dict){var key=this.parsePrimary();if(!this.skip(lexer.TOKEN_COLON)){this.fail('parseAggregate: expected colon after dict key',tok.lineno,tok.colno);}
var value=this.parseExpression();node.addChild(new nodes.Pair(key.lineno,key.colno,key,value));}
else{var expr=this.parseExpression();node.addChild(expr);}}
return node;},parseSignature:function(tolerant,noParens){var tok=this.peekToken();if(!noParens&&tok.type!==lexer.TOKEN_LEFT_PAREN){if(tolerant){return null;}
else{this.fail('expected arguments',tok.lineno,tok.colno);}}
if(tok.type===lexer.TOKEN_LEFT_PAREN){tok=this.nextToken();}
var args=new nodes.NodeList(tok.lineno,tok.colno);var kwargs=new nodes.KeywordArgs(tok.lineno,tok.colno);var kwnames=[];var checkComma=false;while(1){tok=this.peekToken();if(!noParens&&tok.type===lexer.TOKEN_RIGHT_PAREN){this.nextToken();break;}
else if(noParens&&tok.type===lexer.TOKEN_BLOCK_END){break;}
if(checkComma&&!this.skip(lexer.TOKEN_COMMA)){this.fail('parseSignature: expected comma after expression',tok.lineno,tok.colno);}
else{var arg=this.parseExpression();if(this.skipValue(lexer.TOKEN_OPERATOR,'=')){kwargs.addChild(new nodes.Pair(arg.lineno,arg.colno,arg,this.parseExpression()));}
else{args.addChild(arg);}}
checkComma=true;}
if(kwargs.children.length){args.addChild(kwargs);}
return args;},parseUntilBlocks:function(){var prev=this.breakOnBlocks;this.breakOnBlocks=lib.toArray(arguments);var ret=this.parse();this.breakOnBlocks=prev;return ret;},parseNodes:function(){var tok;var buf=[];while((tok=this.nextToken())){if(tok.type===lexer.TOKEN_DATA){var data=tok.value;var nextToken=this.peekToken();var nextVal=nextToken&&nextToken.value;if(this.dropLeadingWhitespace){data=data.replace(/^\s*/,'');this.dropLeadingWhitespace=false;}
if(nextToken&&nextToken.type===lexer.TOKEN_BLOCK_START&&nextVal.charAt(nextVal.length-1)==='-'){data=data.replace(/\s*$/,'');}
buf.push(new nodes.Output(tok.lineno,tok.colno,[new nodes.TemplateData(tok.lineno,tok.colno,data)]));}
else if(tok.type===lexer.TOKEN_BLOCK_START){var n=this.parseStatement();if(!n){break;}
buf.push(n);}
else if(tok.type===lexer.TOKEN_VARIABLE_START){var e=this.parseExpression();this.advanceAfterVariableEnd();buf.push(new nodes.Output(tok.lineno,tok.colno,[e]));}
else if(tok.type!==lexer.TOKEN_COMMENT){this.fail('Unexpected token at top-level: '+
tok.type,tok.lineno,tok.colno);}}
return buf;},parse:function(){return new nodes.NodeList(0,0,this.parseNodes());},parseAsRoot:function(){return new nodes.Root(0,0,this.parseNodes());}});modules['parser']={parse:function(src,extensions,opts){var p=new Parser(lexer.lex(src,opts));if(extensions!==undefined){p.extensions=extensions;}
return p.parseAsRoot();}};})();(function(){'use strict';var nodes=modules["nodes"];var lib=modules["lib"];var sym=0;function gensym(){return 'hole_'+sym++;}
function mapCOW(arr,func){var res=null;for(var i=0;i<arr.length;i++){var item=func(arr[i]);if(item!==arr[i]){if(!res){res=arr.slice();}
res[i]=item;}}
return res||arr;}
function walk(ast,func,depthFirst){if(!(ast instanceof nodes.Node)){return ast;}
if(!depthFirst){var astT=func(ast);if(astT&&astT!==ast){return astT;}}
if(ast instanceof nodes.NodeList){var children=mapCOW(ast.children,function(node){return walk(node,func,depthFirst);});if(children!==ast.children){ast=new nodes[ast.typename](ast.lineno,ast.colno,children);}}
else if(ast instanceof nodes.CallExtension){var args=walk(ast.args,func,depthFirst);var contentArgs=mapCOW(ast.contentArgs,function(node){return walk(node,func,depthFirst);});if(args!==ast.args||contentArgs!==ast.contentArgs){ast=new nodes[ast.typename](ast.extName,ast.prop,args,contentArgs);}}
else{var props=ast.fields.map(function(field){return ast[field];});var propsT=mapCOW(props,function(prop){return walk(prop,func,depthFirst);});if(propsT!==props){ast=new nodes[ast.typename](ast.lineno,ast.colno);propsT.forEach(function(prop,i){ast[ast.fields[i]]=prop;});}}
return depthFirst?(func(ast)||ast):ast;}
function depthWalk(ast,func){return walk(ast,func,true);}
function _liftFilters(node,asyncFilters,prop){var children=[];var walked=depthWalk(prop?node[prop]:node,function(node){if(node instanceof nodes.Block){return node;}
else if((node instanceof nodes.Filter&&lib.indexOf(asyncFilters,node.name.value)!==-1)||node instanceof nodes.CallExtensionAsync){var symbol=new nodes.Symbol(node.lineno,node.colno,gensym());children.push(new nodes.FilterAsync(node.lineno,node.colno,node.name,node.args,symbol));return symbol;}});if(prop){node[prop]=walked;}
else{node=walked;}
if(children.length){children.push(node);return new nodes.NodeList(node.lineno,node.colno,children);}
else{return node;}}
function liftFilters(ast,asyncFilters){return depthWalk(ast,function(node){if(node instanceof nodes.Output){return _liftFilters(node,asyncFilters);}
else if(node instanceof nodes.For){return _liftFilters(node,asyncFilters,'arr');}
else if(node instanceof nodes.If){return _liftFilters(node,asyncFilters,'cond');}
else if(node instanceof nodes.CallExtension){return _liftFilters(node,asyncFilters,'args');}});}
function liftSuper(ast){return walk(ast,function(blockNode){if(!(blockNode instanceof nodes.Block)){return;}
var hasSuper=false;var symbol=gensym();blockNode.body=walk(blockNode.body,function(node){if(node instanceof nodes.FunCall&&node.name.value==='super'){hasSuper=true;return new nodes.Symbol(node.lineno,node.colno,symbol);}});if(hasSuper){blockNode.body.children.unshift(new nodes.Super(0,0,blockNode.name,new nodes.Symbol(0,0,symbol)));}});}
function convertStatements(ast){return depthWalk(ast,function(node){if(!(node instanceof nodes.If)&&!(node instanceof nodes.For)){return;}
var async=false;walk(node,function(node){if(node instanceof nodes.FilterAsync||node instanceof nodes.IfAsync||node instanceof nodes.AsyncEach||node instanceof nodes.AsyncAll||node instanceof nodes.CallExtensionAsync){async=true;return node;}});if(async){if(node instanceof nodes.If){return new nodes.IfAsync(node.lineno,node.colno,node.cond,node.body,node.else_);}
else if(node instanceof nodes.For){return new nodes.AsyncEach(node.lineno,node.colno,node.arr,node.name,node.body,node.else_);}}});}
function cps(ast,asyncFilters){return convertStatements(liftSuper(liftFilters(ast,asyncFilters)));}
function transform(ast,asyncFilters,name){return cps(ast,asyncFilters||[]);}
modules['transformer']={transform:transform};})();(function(){'use strict';var lib=modules["lib"];var parser=modules["parser"];var transformer=modules["transformer"];var nodes=modules["nodes"];var Object=modules["object"];var Frame=modules["runtime"].Frame;var compareOps={'==':'==','!=':'!=','<':'<','>':'>','<=':'<=','>=':'>='};function binOpEmitter(str){return function(node,frame){this.compile(node.left,frame);this.emit(str);this.compile(node.right,frame);};}
var Compiler=Object.extend({init:function(templateName){this.templateName=templateName;this.codebuf=[];this.lastId=0;this.buffer=null;this.bufferStack=[];this.isChild=false;this.scopeClosers='';},fail:function(msg,lineno,colno){if(lineno!==undefined)lineno+=1;if(colno!==undefined)colno+=1;throw new lib.TemplateError(msg,lineno,colno);},pushBufferId:function(id){this.bufferStack.push(this.buffer);this.buffer=id;this.emit('var '+this.buffer+' = "";');},popBufferId:function(){this.buffer=this.bufferStack.pop();},emit:function(code){this.codebuf.push(code);},emitLine:function(code){this.emit(code+'\n');},emitLines:function(){lib.each(lib.toArray(arguments),function(line){this.emitLine(line);},this);},emitFuncBegin:function(name){this.buffer='output';this.scopeClosers='';this.emitLine('function '+name+'(env, context, frame, runtime, cb) {');this.emitLine('var lineno = null;');this.emitLine('var colno = null;');this.emitLine('var '+this.buffer+' = "";');this.emitLine('try {');},emitFuncEnd:function(noReturn){if(!noReturn){this.emitLine('cb(null, '+this.buffer+');');}
this.closeScopeLevels();this.emitLine('} catch (e) {');this.emitLine('  cb(runtime.handleError(e, lineno, colno));');this.emitLine('}');this.emitLine('}');this.buffer=null;},addScopeLevel:function(){this.scopeClosers+='})';},closeScopeLevels:function(){this.emitLine(this.scopeClosers+';');this.scopeClosers='';},withScopedSyntax:function(func){var scopeClosers=this.scopeClosers;this.scopeClosers='';func.call(this);this.closeScopeLevels();this.scopeClosers=scopeClosers;},makeCallback:function(res){var err=this.tmpid();return 'function('+err+(res?','+res:'')+') {\n'+
'if('+err+') { cb('+err+'); return; }';},tmpid:function(){this.lastId++;return 't_'+this.lastId;},_templateName:function(){return this.templateName==null?'undefined':JSON.stringify(this.templateName);},_bufferAppend:function(func){this.emit(this.buffer+' += runtime.suppressValue(');func.call(this);this.emit(', env.opts.autoescape);\n');},_compileChildren:function(node,frame){var children=node.children;for(var i=0,l=children.length;i<l;i++){this.compile(children[i],frame);}},_compileAggregate:function(node,frame,startChar,endChar){if(startChar){this.emit(startChar);}
for(var i=0;i<node.children.length;i++){if(i>0){this.emit(',');}
this.compile(node.children[i],frame);}
if(endChar){this.emit(endChar);}},_compileExpression:function(node,frame){this.assertType(node,nodes.Literal,nodes.Symbol,nodes.Group,nodes.Array,nodes.Dict,nodes.FunCall,nodes.Caller,nodes.Filter,nodes.LookupVal,nodes.Compare,nodes.InlineIf,nodes.In,nodes.And,nodes.Or,nodes.Not,nodes.Add,nodes.Sub,nodes.Mul,nodes.Div,nodes.FloorDiv,nodes.Mod,nodes.Pow,nodes.Neg,nodes.Pos,nodes.Compare,nodes.NodeList);this.compile(node,frame);},assertType:function(node){var types=lib.toArray(arguments).slice(1);var success=false;for(var i=0;i<types.length;i++){if(node instanceof types[i]){success=true;}}
if(!success){this.fail('assertType: invalid type: '+node.typename,node.lineno,node.colno);}},compileCallExtension:function(node,frame,async){var name=node.extName;var args=node.args;var contentArgs=node.contentArgs;var autoescape=typeof node.autoescape==='boolean'?node.autoescape:true;var transformedArgs=[];if(!async){this.emit(this.buffer+' += runtime.suppressValue(');}
this.emit('env.getExtension("'+node.extName+'")["'+node.prop+'"](');this.emit('context');if(args||contentArgs){this.emit(',');}
if(args){if(!(args instanceof nodes.NodeList)){this.fail('compileCallExtension: arguments must be a NodeList, '+
'use `parser.parseSignature`');}
lib.each(args.children,function(arg,i){this._compileExpression(arg,frame);if(i!==args.children.length-1||contentArgs.length){this.emit(',');}},this);}
if(contentArgs.length){lib.each(contentArgs,function(arg,i){if(i>0){this.emit(',');}
if(arg){var id=this.tmpid();this.emitLine('function(cb) {');this.emitLine('if(!cb) { cb = function(err) { if(err) { throw err; }}}');this.pushBufferId(id);this.withScopedSyntax(function(){this.compile(arg,frame);this.emitLine('cb(null, '+id+');');});this.popBufferId();this.emitLine('return '+id+';');this.emitLine('}');}
else{this.emit('null');}},this);}
if(async){var res=this.tmpid();this.emitLine(', '+this.makeCallback(res));this.emitLine(this.buffer+' += runtime.suppressValue('+res+', '+autoescape+' && env.opts.autoescape);');this.addScopeLevel();}
else{this.emit(')');this.emit(', '+autoescape+' && env.opts.autoescape);\n');}},compileCallExtensionAsync:function(node,frame){this.compileCallExtension(node,frame,true);},compileNodeList:function(node,frame){this._compileChildren(node,frame);},compileLiteral:function(node,frame){if(typeof node.value==='string'){var val=node.value.replace(/\\/g,'\\\\');val=val.replace(/"/g,'\\"');val=val.replace(/\n/g,'\\n');val=val.replace(/\r/g,'\\r');val=val.replace(/\t/g,'\\t');this.emit('"'+val+'"');}
else{this.emit(node.value.toString());}},compileSymbol:function(node,frame){var name=node.value;var v;if((v=frame.lookup(name))){this.emit(v);}
else{this.emit('runtime.contextOrFrameLookup('+
'context, frame, "'+name+'")');}},compileGroup:function(node,frame){this._compileAggregate(node,frame,'(',')');},compileArray:function(node,frame){this._compileAggregate(node,frame,'[',']');},compileDict:function(node,frame){this._compileAggregate(node,frame,'{','}');},compilePair:function(node,frame){var key=node.key;var val=node.value;if(key instanceof nodes.Symbol){key=new nodes.Literal(key.lineno,key.colno,key.value);}
else if(!(key instanceof nodes.Literal&&typeof key.value==='string')){this.fail('compilePair: Dict keys must be strings or names',key.lineno,key.colno);}
this.compile(key,frame);this.emit(': ');this._compileExpression(val,frame);},compileInlineIf:function(node,frame){this.emit('(');this.compile(node.cond,frame);this.emit('?');this.compile(node.body,frame);this.emit(':');if(node.else_!==null)
this.compile(node.else_,frame);else
this.emit('""');this.emit(')');},compileIn:function(node,frame){this.emit('(');this.compile(node.right,frame);this.emit('.indexOf(');this.compile(node.left,frame);this.emit(') !== -1)');},compileOr:binOpEmitter(' || '),compileAnd:binOpEmitter(' && '),compileAdd:binOpEmitter(' + '),compileSub:binOpEmitter(' - '),compileMul:binOpEmitter(' * '),compileDiv:binOpEmitter(' / '),compileMod:binOpEmitter(' % '),compileNot:function(node,frame){this.emit('!');this.compile(node.target,frame);},compileFloorDiv:function(node,frame){this.emit('Math.floor(');this.compile(node.left,frame);this.emit(' / ');this.compile(node.right,frame);this.emit(')');},compilePow:function(node,frame){this.emit('Math.pow(');this.compile(node.left,frame);this.emit(', ');this.compile(node.right,frame);this.emit(')');},compileNeg:function(node,frame){this.emit('-');this.compile(node.target,frame);},compilePos:function(node,frame){this.emit('+');this.compile(node.target,frame);},compileCompare:function(node,frame){this.compile(node.expr,frame);for(var i=0;i<node.ops.length;i++){var n=node.ops[i];this.emit(' '+compareOps[n.type]+' ');this.compile(n.expr,frame);}},compileLookupVal:function(node,frame){this.emit('runtime.memberLookup((');this._compileExpression(node.target,frame);this.emit('),');this._compileExpression(node.val,frame);this.emit(', env.opts.autoescape)');},_getNodeName:function(node){switch(node.typename){case 'Symbol':return node.value;case 'FunCall':return 'the return value of ('+this._getNodeName(node.name)+')';case 'LookupVal':return this._getNodeName(node.target)+'["'+
this._getNodeName(node.val)+'"]';case 'Literal':return node.value.toString().substr(0,10);default:return '--expression--';}},compileFunCall:function(node,frame){this.emit('(lineno = '+node.lineno+
', colno = '+node.colno+', ');this.emit('runtime.callWrap(');this._compileExpression(node.name,frame);this.emit(', "'+this._getNodeName(node.name).replace(/"/g,'\\"')+'", ');this._compileAggregate(node.args,frame,'[','])');this.emit(')');},compileFilter:function(node,frame){var name=node.name;this.assertType(name,nodes.Symbol);this.emit('env.getFilter("'+name.value+'").call(context, ');this._compileAggregate(node.args,frame);this.emit(')');},compileFilterAsync:function(node,frame){var name=node.name;this.assertType(name,nodes.Symbol);var symbol=node.symbol.value;frame.set(symbol,symbol);this.emit('env.getFilter("'+name.value+'").call(context, ');this._compileAggregate(node.args,frame);this.emitLine(', '+this.makeCallback(symbol));this.addScopeLevel();},compileKeywordArgs:function(node,frame){var names=[];lib.each(node.children,function(pair){names.push(pair.key.value);});this.emit('runtime.makeKeywordArgs(');this.compileDict(node,frame);this.emit(')');},compileSet:function(node,frame){var ids=[];lib.each(node.targets,function(target){var name=target.value;var id=frame.lookup(name);if(id===null||id===undefined){id=this.tmpid();this.emitLine('var '+id+';');}
ids.push(id);},this);this.emit(ids.join(' = ')+' = ');this._compileExpression(node.value,frame);this.emitLine(';');lib.each(node.targets,function(target,i){var id=ids[i];var name=target.value;this.emitLine('frame.set("'+name+'", '+id+', true);');this.emitLine('if(!frame.parent) {');this.emitLine('context.setVariable("'+name+'", '+id+');');if(name.charAt(0)!=='_'){this.emitLine('context.addExport("'+name+'");');}
this.emitLine('}');},this);},compileIf:function(node,frame,async){this.emit('if(');this._compileExpression(node.cond,frame);this.emitLine(') {');this.withScopedSyntax(function(){this.compile(node.body,frame);if(async){this.emit('cb()');}});if(node.else_){this.emitLine('}\nelse {');this.withScopedSyntax(function(){this.compile(node.else_,frame);if(async){this.emit('cb()');}});}else if(async){this.emitLine('}\nelse {');this.emit('cb()');}
this.emitLine('}');},compileIfAsync:function(node,frame){this.emit('(function(cb) {');this.compileIf(node,frame,true);this.emit('})(function() {');this.addScopeLevel();},emitLoopBindings:function(node,arr,i,len){var bindings={index:i+' + 1',index0:i,revindex:len+' - '+i,revindex0:len+' - '+i+' - 1',first:i+' === 0',last:i+' === '+len+' - 1',length:len};for(var name in bindings){this.emitLine('frame.set("loop.'+name+'", '+bindings[name]+');');}},compileFor:function(node,frame){var i=this.tmpid();var len=this.tmpid();var arr=this.tmpid();frame=frame.push();this.emitLine('frame = frame.push();');this.emit('var '+arr+' = ');this._compileExpression(node.arr,frame);this.emitLine(';');this.emit('if('+arr+') {');if(node.name instanceof nodes.Array){this.emitLine('var '+i+';');this.emitLine('if(runtime.isArray('+arr+')) {');{this.emitLine('var '+len+' = '+arr+'.length;');this.emitLine('for('+i+'=0; '+i+' < '+arr+'.length; '
+i+'++) {');for(var u=0;u<node.name.children.length;u++){var tid=this.tmpid();this.emitLine('var '+tid+' = '+arr+'['+i+']['+u+']');this.emitLine('frame.set("'+node.name.children[u].value
+'", '+arr+'['+i+']['+u+']'+');');frame.set(node.name.children[u].value,tid);}
this.emitLoopBindings(node,arr,i,len);this.withScopedSyntax(function(){this.compile(node.body,frame);});this.emitLine('}');}
this.emitLine('} else {');{var key=node.name.children[0];var val=node.name.children[1];var k=this.tmpid();var v=this.tmpid();frame.set(key.value,k);frame.set(val.value,v);this.emitLine(i+' = -1;');this.emitLine('var '+len+' = runtime.keys('+arr+').length;');this.emitLine('for(var '+k+' in '+arr+') {');this.emitLine(i+'++;');this.emitLine('var '+v+' = '+arr+'['+k+'];');this.emitLine('frame.set("'+key.value+'", '+k+');');this.emitLine('frame.set("'+val.value+'", '+v+');');this.emitLoopBindings(node,arr,i,len);this.withScopedSyntax(function(){this.compile(node.body,frame);});this.emitLine('}');}
this.emitLine('}');}
else{var v=this.tmpid();frame.set(node.name.value,v);this.emitLine('var '+len+' = '+arr+'.length;');this.emitLine('for(var '+i+'=0; '+i+' < '+arr+'.length; '+
i+'++) {');this.emitLine('var '+v+' = '+arr+'['+i+'];');this.emitLine('frame.set("'+node.name.value+'", '+v+');');this.emitLoopBindings(node,arr,i,len);this.withScopedSyntax(function(){this.compile(node.body,frame);});this.emitLine('}');}
this.emitLine('}');if(node.else_){this.emitLine('if (!'+len+') {');this.compile(node.else_,frame);this.emitLine('}');}
this.emitLine('frame = frame.pop();');},_compileAsyncLoop:function(node,frame,parallel){var i=this.tmpid();var len=this.tmpid();var arr=this.tmpid();var asyncMethod=parallel?'asyncAll':'asyncEach';frame=frame.push();this.emitLine('frame = frame.push();');this.emit('var '+arr+' = ');this._compileExpression(node.arr,frame);this.emitLine(';');if(node.name instanceof nodes.Array){this.emit('runtime.'+asyncMethod+'('+arr+', '+
node.name.children.length+', function(');lib.each(node.name.children,function(name){this.emit(name.value+',');},this);this.emit(i+','+len+',next) {');lib.each(node.name.children,function(name){var id=name.value;frame.set(id,id);this.emitLine('frame.set("'+id+'", '+id+');');},this);}
else{var id=node.name.value;this.emitLine('runtime.'+asyncMethod+'('+arr+', 1, function('+id+', '+i+', '+len+',next) {');this.emitLine('frame.set("'+id+'", '+id+');');frame.set(id,id);}
this.emitLoopBindings(node,arr,i,len);this.withScopedSyntax(function(){var buf;if(parallel){buf=this.tmpid();this.pushBufferId(buf);}
this.compile(node.body,frame);this.emitLine('next('+i+(buf?','+buf:'')+');');if(parallel){this.popBufferId();}});var output=this.tmpid();this.emitLine('}, '+this.makeCallback(output));this.addScopeLevel();if(parallel){this.emitLine(this.buffer+' += '+output+';');}
if(node.else_){this.emitLine('if (!'+arr+'.length) {');this.compile(node.else_,frame);this.emitLine('}');}
this.emitLine('frame = frame.pop();');},compileAsyncEach:function(node,frame){this._compileAsyncLoop(node,frame);},compileAsyncAll:function(node,frame){this._compileAsyncLoop(node,frame,true);},_compileMacro:function(node,frame){var args=[];var kwargs=null;var funcId='macro_'+this.tmpid();lib.each(node.args.children,function(arg,i){if(i===node.args.children.length-1&&arg instanceof nodes.Dict){kwargs=arg;}
else{this.assertType(arg,nodes.Symbol);args.push(arg);}},this);var realNames=lib.map(args,function(n){return 'l_'+n.value;});realNames.push('kwargs');var argNames=lib.map(args,function(n){return '"'+n.value+'"';});var kwargNames=lib.map((kwargs&&kwargs.children)||[],function(n){return '"'+n.key.value+'"';});frame=frame.push();this.emitLines('var '+funcId+' = runtime.makeMacro(','['+argNames.join(', ')+'], ','['+kwargNames.join(', ')+'], ','function ('+realNames.join(', ')+') {','frame = frame.push();','kwargs = kwargs || {};','if (kwargs.hasOwnProperty("caller")) {','frame.set("caller", kwargs.caller); }');lib.each(args,function(arg){this.emitLine('frame.set("'+arg.value+'", '+
'l_'+arg.value+');');frame.set(arg.value,'l_'+arg.value);},this);if(kwargs){lib.each(kwargs.children,function(pair){var name=pair.key.value;this.emit('frame.set("'+name+'", '+
'kwargs.hasOwnProperty("'+name+'") ? '+
'kwargs["'+name+'"] : ');this._compileExpression(pair.value,frame);this.emitLine(');');},this);}
var bufferId=this.tmpid();this.pushBufferId(bufferId);this.withScopedSyntax(function(){this.compile(node.body,frame);});frame=frame.pop();this.emitLine('frame = frame.pop();');this.emitLine('return new runtime.SafeString('+bufferId+');');this.emitLine('});');this.popBufferId();return funcId;},compileMacro:function(node,frame){var funcId=this._compileMacro(node,frame);var name=node.name.value;frame.set(name,funcId);if(frame.parent){this.emitLine('frame.set("'+name+'", '+funcId+');');}
else{if(node.name.value.charAt(0)!=='_'){this.emitLine('context.addExport("'+name+'");');}
this.emitLine('context.setVariable("'+name+'", '+funcId+');');}},compileCaller:function(node,frame){this.emit('(function (){');var funcId=this._compileMacro(node,frame);this.emit('return '+funcId+';})()');},compileImport:function(node,frame){var id=this.tmpid();var target=node.target.value;this.emit('env.getTemplate(');this._compileExpression(node.template,frame);this.emitLine(', false, '+this._templateName()+', '+this.makeCallback(id));this.addScopeLevel();this.emitLine(id+'.getExported('+
(node.withContext?'context.getVariables(), frame.push(), ':'')+
this.makeCallback(id));this.addScopeLevel();frame.set(target,id);if(frame.parent){this.emitLine('frame.set("'+target+'", '+id+');');}
else{this.emitLine('context.setVariable("'+target+'", '+id+');');}},compileFromImport:function(node,frame){var importedId=this.tmpid();this.emit('env.getTemplate(');this._compileExpression(node.template,frame);this.emitLine(', false, '+this._templateName()+', '+this.makeCallback(importedId));this.addScopeLevel();this.emitLine(importedId+'.getExported('+
(node.withContext?'context.getVariables(), frame.push(), ':'')+
this.makeCallback(importedId));this.addScopeLevel();lib.each(node.names.children,function(nameNode){var name;var alias;var id=this.tmpid();if(nameNode instanceof nodes.Pair){name=nameNode.key.value;alias=nameNode.value.value;}
else{name=nameNode.value;alias=name;}
this.emitLine('if('+importedId+'.hasOwnProperty("'+name+'")) {');this.emitLine('var '+id+' = '+importedId+'.'+name+';');this.emitLine('} else {');this.emitLine('cb(new Error("cannot import \''+name+'\'")); return;');this.emitLine('}');frame.set(alias,id);if(frame.parent){this.emitLine('frame.set("'+alias+'", '+id+');');}
else{this.emitLine('context.setVariable("'+alias+'", '+id+');');}},this);},compileBlock:function(node,frame){if(!this.isChild){var id=this.tmpid();this.emitLine('context.getBlock("'+node.name.value+'")'+
'(env, context, frame, runtime, '+this.makeCallback(id));this.emitLine(this.buffer+' += '+id+';');this.addScopeLevel();}},compileSuper:function(node,frame){var name=node.blockName.value;var id=node.symbol.value;this.emitLine('context.getSuper(env, '+
'"'+name+'", '+
'b_'+name+', '+
'frame, runtime, '+
this.makeCallback(id));this.emitLine(id+' = runtime.markSafe('+id+');');this.addScopeLevel();frame.set(id,id);},compileExtends:function(node,frame){if(this.isChild){this.fail('compileExtends: cannot extend multiple times',node.template.lineno,node.template.colno);}
var k=this.tmpid();this.emit('env.getTemplate(');this._compileExpression(node.template,frame);this.emitLine(', true, '+this._templateName()+', '+this.makeCallback('parentTemplate'));this.emitLine('for(var '+k+' in parentTemplate.blocks) {');this.emitLine('context.addBlock('+k+
', parentTemplate.blocks['+k+']);');this.emitLine('}');this.addScopeLevel();this.isChild=true;},compileInclude:function(node,frame){var id=this.tmpid();var id2=this.tmpid();this.emit('env.getTemplate(');this._compileExpression(node.template,frame);this.emitLine(', false, '+this._templateName()+', '+this.makeCallback(id));this.addScopeLevel();this.emitLine(id+'.render('+
'context.getVariables(), frame.push(), '+this.makeCallback(id2));this.emitLine(this.buffer+' += '+id2);this.addScopeLevel();},compileTemplateData:function(node,frame){this.compileLiteral(node,frame);},compileOutput:function(node,frame){var children=node.children;for(var i=0,l=children.length;i<l;i++){if(children[i]instanceof nodes.TemplateData){if(children[i].value){this.emit(this.buffer+' += ');this.compileLiteral(children[i],frame);this.emitLine(';');}}
else{this.emit(this.buffer+' += runtime.suppressValue(');this.compile(children[i],frame);this.emit(', env.opts.autoescape);\n');}}},compileRoot:function(node,frame){if(frame){this.fail('compileRoot: root node can\'t have frame');}
frame=new Frame();this.emitFuncBegin('root');this._compileChildren(node,frame);if(this.isChild){this.emitLine('parentTemplate.rootRenderFunc(env, context, frame, runtime, cb);');}
this.emitFuncEnd(this.isChild);this.isChild=false;var blocks=node.findAll(nodes.Block);for(var i=0;i<blocks.length;i++){var block=blocks[i];var name=block.name.value;this.emitFuncBegin('b_'+name);var tmpFrame=new Frame();this.compile(block.body,tmpFrame);this.emitFuncEnd();}
this.emitLine('return {');for(var i=0;i<blocks.length;i++){var block=blocks[i];var name='b_'+block.name.value;this.emitLine(name+': '+name+',');}
this.emitLine('root: root\n};');},compile:function(node,frame){var _compile=this['compile'+node.typename];if(_compile){_compile.call(this,node,frame);}
else{this.fail('compile: Cannot compile node: '+node.typename,node.lineno,node.colno);}},getCode:function(){return this.codebuf.join('');}});modules['compiler']={compile:function(src,asyncFilters,extensions,name,opts){var c=new Compiler(name);if(extensions&&extensions.length){for(var i=0;i<extensions.length;i++){if('preprocess'in extensions[i]){src=extensions[i].preprocess(src,name);}}}
c.compile(transformer.transform(parser.parse(src,extensions,opts),asyncFilters,name));return c.getCode();},Compiler:Compiler};})();(function(){'use strict';var lib=modules["lib"];var r=modules["runtime"];var filters={abs:function(n){return Math.abs(n);},batch:function(arr,linecount,fill_with){var res=[];var tmp=[];for(var i=0;i<arr.length;i++){if(i%linecount===0&&tmp.length){res.push(tmp);tmp=[];}
tmp.push(arr[i]);}
if(tmp.length){if(fill_with){for(var i=tmp.length;i<linecount;i++){tmp.push(fill_with);}}
res.push(tmp);}
return res;},capitalize:function(str){var ret=str.toLowerCase();return r.copySafeness(str,ret.charAt(0).toUpperCase()+ret.slice(1));},center:function(str,width){width=width||80;if(str.length>=width){return str;}
var spaces=width-str.length;var pre=lib.repeat(' ',spaces/2-spaces%2);var post=lib.repeat(' ',spaces/2);return r.copySafeness(str,pre+str+post);},'default':function(val,def){return val?val:def;},dictsort:function(val,case_sensitive,by){if(!lib.isObject(val)){throw new lib.TemplateError('dictsort filter: val must be an object');}
var array=[];for(var k in val){array.push([k,val[k]]);}
var si;if(by===undefined||by==='key'){si=0;}else if(by==='value'){si=1;}else{throw new lib.TemplateError('dictsort filter: You can only sort by either key or value');}
array.sort(function(t1,t2){var a=t1[si];var b=t2[si];if(!case_sensitive){if(lib.isString(a)){a=a.toUpperCase();}
if(lib.isString(b)){b=b.toUpperCase();}}
return a>b?1:(a===b?0:-1);});return array;},escape:function(str){if(typeof str==='string'||str instanceof r.SafeString){return lib.escape(str);}
return str;},safe:function(str){return r.markSafe(str);},first:function(arr){return arr[0];},groupby:function(arr,attr){return lib.groupBy(arr,attr);},indent:function(str,width,indentfirst){width=width||4;var res='';var lines=str.split('\n');var sp=lib.repeat(' ',width);for(var i=0;i<lines.length;i++){if(i===0&&!indentfirst){res+=lines[i]+'\n';}
else{res+=sp+lines[i]+'\n';}}
return r.copySafeness(str,res);},join:function(arr,del,attr){del=del||'';if(attr){arr=lib.map(arr,function(v){return v[attr];});}
return arr.join(del);},last:function(arr){return arr[arr.length-1];},length:function(arr){return arr!==undefined?arr.length:0;},list:function(val){if(lib.isString(val)){return val.split('');}
else if(lib.isObject(val)){var keys=[];if(Object.keys){keys=Object.keys(val);}
else{for(var k in val){keys.push(k);}}
return lib.map(keys,function(k){return{key:k,value:val[k]};});}
else if(lib.isArray(val)){return val;}
else{throw new lib.TemplateError('list filter: type not iterable');}},lower:function(str){return str.toLowerCase();},random:function(arr){return arr[Math.floor(Math.random()*arr.length)];},rejectattr:function(arr,attr){return arr.filter(function(item){return!item[attr];});},selectattr:function(arr,attr){return arr.filter(function(item){return!!item[attr];});},replace:function(str,old,new_,maxCount){if(old instanceof RegExp){return str.replace(old,new_);}
var res=str;var last=res;var count=1;res=res.replace(old,new_);while(last!==res){if(count>=maxCount){break;}
last=res;res=res.replace(old,new_);count++;}
return r.copySafeness(str,res);},reverse:function(val){var arr;if(lib.isString(val)){arr=filters.list(val);}
else{arr=lib.map(val,function(v){return v;});}
arr.reverse();if(lib.isString(val)){return r.copySafeness(val,arr.join(''));}
return arr;},round:function(val,precision,method){precision=precision||0;var factor=Math.pow(10,precision);var rounder;if(method==='ceil'){rounder=Math.ceil;}
else if(method==='floor'){rounder=Math.floor;}
else{rounder=Math.round;}
return rounder(val*factor)/factor;},slice:function(arr,slices,fillWith){var sliceLength=Math.floor(arr.length/slices);var extra=arr.length%slices;var offset=0;var res=[];for(var i=0;i<slices;i++){var start=offset+i*sliceLength;if(i<extra){offset++;}
var end=offset+(i+1)*sliceLength;var slice=arr.slice(start,end);if(fillWith&&i>=extra){slice.push(fillWith);}
res.push(slice);}
return res;},sort:function(arr,reverse,caseSens,attr){arr=lib.map(arr,function(v){return v;});arr.sort(function(a,b){var x,y;if(attr){x=a[attr];y=b[attr];}
else{x=a;y=b;}
if(!caseSens&&lib.isString(x)&&lib.isString(y)){x=x.toLowerCase();y=y.toLowerCase();}
if(x<y){return reverse?1:-1;}
else if(x>y){return reverse?-1:1;}
else{return 0;}});return arr;},string:function(obj){return r.copySafeness(obj,obj);},title:function(str){var words=str.split(' ');for(var i=0;i<words.length;i++){words[i]=filters.capitalize(words[i]);}
return r.copySafeness(str,words.join(' '));},trim:function(str){return r.copySafeness(str,str.replace(/^\s*|\s*$/g,''));},truncate:function(input,length,killwords,end){var orig=input;length=length||255;if(input.length<=length)
return input;if(killwords){input=input.substring(0,length);}else{var idx=input.lastIndexOf(' ',length);if(idx===-1){idx=length;}
input=input.substring(0,idx);}
input+=(end!==undefined&&end!==null)?end:'...';return r.copySafeness(orig,input);},upper:function(str){return str.toUpperCase();},urlencode:function(obj){var enc=encodeURIComponent;if(lib.isString(obj)){return enc(obj);}else{var parts;if(lib.isArray(obj)){parts=obj.map(function(item){return enc(item[0])+'='+enc(item[1]);})}else{parts=[];for(var k in obj){if(obj.hasOwnProperty(k)){parts.push(enc(k)+'='+enc(obj[k]));}}}
return parts.join('&');}},urlize:function(str,length,nofollow){if(isNaN(length))length=Infinity;var noFollowAttr=(nofollow===true?' rel="nofollow"':'');var puncRE=/^(?:\(|<|&lt;)?(.*?)(?:\.|,|\)|\n|&gt;)?$/;var emailRE=/^[\w.!#$%&'*+\-\/=?\^`{|}~]+@[a-z\d\-]+(\.[a-z\d\-]+)+$/i;var httpHttpsRE=/^https?:\/\/.*$/;var wwwRE=/^www\./;var tldRE=/\.(?:org|net|com)(?:\:|\/|$)/;var words=str.split(/\s+/).filter(function(word){return word&&word.length;}).map(function(word){var matches=word.match(puncRE);var possibleUrl=matches&&matches[1]||word;if(httpHttpsRE.test(possibleUrl))
return '<a href="'+possibleUrl+'"'+noFollowAttr+'>'+possibleUrl.substr(0,length)+'</a>';if(wwwRE.test(possibleUrl))
return '<a href="http://'+possibleUrl+'"'+noFollowAttr+'>'+possibleUrl.substr(0,length)+'</a>';if(emailRE.test(possibleUrl))
return '<a href="mailto:'+possibleUrl+'">'+possibleUrl+'</a>';if(tldRE.test(possibleUrl))
return '<a href="http://'+possibleUrl+'"'+noFollowAttr+'>'+possibleUrl.substr(0,length)+'</a>';return word;});return words.join(' ');},wordcount:function(str){var words=(str)?str.match(/\w+/g):null;return(words)?words.length:null;},'float':function(val,def){var res=parseFloat(val);return isNaN(res)?def:res;},'int':function(val,def){var res=parseInt(val,10);return isNaN(res)?def:res;}};filters.d=filters['default'];filters.e=filters.escape;modules['filters']=filters;})();(function(){'use strict';function cycler(items){var index=-1;return{current:null,reset:function(){index=-1;this.current=null;},next:function(){index++;if(index>=items.length){index=0;}
this.current=items[index];return this.current;},};}
function joiner(sep){sep=sep||',';var first=true;return function(){var val=first?'':sep;first=false;return val;};}
var globals={range:function(start,stop,step){if(!stop){stop=start;start=0;step=1;}
else if(!step){step=1;}
var arr=[];for(var i=start;i<stop;i+=step){arr.push(i);}
return arr;},cycler:function(){return cycler(Array.prototype.slice.call(arguments));},joiner:function(sep){return joiner(sep);}}
modules['globals']=globals;})();(function(){'use strict';var path=modules["path"];var Obj=modules["object"];var lib=modules["lib"];var Loader=Obj.extend({on:function(name,func){this.listeners=this.listeners||{};this.listeners[name]=this.listeners[name]||[];this.listeners[name].push(func);},emit:function(name){var args=Array.prototype.slice.call(arguments,1);if(this.listeners&&this.listeners[name]){lib.each(this.listeners[name],function(listener){listener.apply(null,args);});}},resolve:function(from,to){return path.resolve(path.dirname(from),to);},isRelative:function(filename){return(filename.indexOf('./')===0||filename.indexOf('../')===0);}});modules['loader']=Loader;})();(function(){'use strict';var Loader=modules["loader"];var WebLoader=Loader.extend({init:function(baseURL,neverUpdate){this.precompiled=window.nunjucksPrecompiled||{};this.baseURL=baseURL||'';this.neverUpdate=neverUpdate;},getSource:function(name){if(this.precompiled[name]){return{src:{type:'code',obj:this.precompiled[name]},path:name};}
else{var src=this.fetch(this.baseURL+'/'+name);if(!src){return null;}
return{src:src,path:name,noCache:!this.neverUpdate};}},fetch:function(url,callback){var ajax;var loading=true;var src;if(window.XMLHttpRequest){ajax=new XMLHttpRequest();}
else if(window.ActiveXObject){ajax=new ActiveXObject('Microsoft.XMLHTTP');}
ajax.onreadystatechange=function(){if(ajax.readyState===4&&(ajax.status===0||ajax.status===200)&&loading){loading=false;src=ajax.responseText;}};url+=(url.indexOf('?')===-1?'?':'&')+'s='+
(new Date().getTime());ajax.open('GET',url,false);ajax.send();return src;}});modules['web-loaders']={WebLoader:WebLoader};})();(function(){if(typeof window==='undefined'||window!==this){modules['loaders']=modules["node-loaders"];}
else{modules['loaders']=modules["web-loaders"];}})();(function(){'use strict';var path=modules["path"];var lib=modules["lib"];var Obj=modules["object"];var lexer=modules["lexer"];var compiler=modules["compiler"];var builtin_filters=modules["filters"];var builtin_loaders=modules["loaders"];var runtime=modules["runtime"];var globals=modules["globals"];var Frame=runtime.Frame;var Environment=Obj.extend({init:function(loaders,opts){var opts=this.opts=opts||{};this.opts.dev=!!opts.dev;this.opts.autoescape=!!opts.autoescape;this.opts.trimBlocks=!!opts.trimBlocks;this.opts.lstripBlocks=!!opts.lstripBlocks;if(!loaders){if(builtin_loaders.FileSystemLoader){this.loaders=[new builtin_loaders.FileSystemLoader('views')];}
else{this.loaders=[new builtin_loaders.WebLoader('/views')];}}
else{this.loaders=lib.isArray(loaders)?loaders:[loaders];}
this.initCache();this.filters={};this.asyncFilters=[];this.extensions={};this.extensionsList=[];for(var name in builtin_filters){this.addFilter(name,builtin_filters[name]);}},initCache:function(){lib.each(this.loaders,function(loader){loader.cache={};if(typeof loader.on==='function'){loader.on('update',function(template){loader.cache[template]=null;});}});},addExtension:function(name,extension){extension._name=name;this.extensions[name]=extension;this.extensionsList.push(extension);},getExtension:function(name){return this.extensions[name];},addGlobal:function(name,value){globals[name]=value;},addFilter:function(name,func,async){var wrapped=func;if(async){this.asyncFilters.push(name);}
this.filters[name]=wrapped;},getFilter:function(name){if(!this.filters[name]){throw new Error('filter not found: '+name);}
return this.filters[name];},resolveTemplate:function(loader,parentName,filename){var isRelative=(loader.isRelative&&parentName)?loader.isRelative(filename):false;return(isRelative&&loader.resolve)?loader.resolve(parentName,filename):filename;},getTemplate:function(name,eagerCompile,parentName,cb){var that=this;var tmpl=null;if(name&&name.raw){name=name.raw;}
if(lib.isFunction(parentName)){cb=parentName;parentName=null;eagerCompile=eagerCompile||false;}
if(lib.isFunction(eagerCompile)){cb=eagerCompile;eagerCompile=false;}
if(typeof name!=='string'){throw new Error('template names must be a string: '+name);}
for(var i=0;i<this.loaders.length;i++){var _name=this.resolveTemplate(this.loaders[i],parentName,name);tmpl=this.loaders[i].cache[_name];if(tmpl)break;}
if(tmpl){if(eagerCompile){tmpl.compile();}
if(cb){cb(null,tmpl);}
else{return tmpl;}}else{var syncResult;lib.asyncIter(this.loaders,function(loader,i,next,done){function handle(src){if(src){src.loader=loader;done(src);}
else{next();}}
name=that.resolveTemplate(loader,parentName,name);if(loader.async){loader.getSource(name,function(err,src){if(err){throw err;}
handle(src);});}
else{handle(loader.getSource(name));}},function(info){if(!info){var err=new Error('template not found: '+name);if(cb){cb(err);}
else{throw err;}}
else{var tmpl=new Template(info.src,this,info.path,eagerCompile);if(!info.noCache){info.loader.cache[name]=tmpl;}
if(cb){cb(null,tmpl);}
else{syncResult=tmpl;}}}.bind(this));return syncResult;}},express:function(app){var env=this;function NunjucksView(name,opts){this.name=name;this.path=name;this.defaultEngine=opts.defaultEngine;this.ext=path.extname(name);if(!this.ext&&!this.defaultEngine)throw new Error('No default engine was specified and no extension was provided.');if(!this.ext)this.name+=(this.ext=('.'!==this.defaultEngine[0]?'.':'')+this.defaultEngine);}
NunjucksView.prototype.render=function(opts,cb){env.render(this.name,opts,cb);};app.set('view',NunjucksView);},render:function(name,ctx,cb){if(lib.isFunction(ctx)){cb=ctx;ctx=null;}
var syncResult=null;this.getTemplate(name,function(err,tmpl){if(err&&cb){cb(err);}
else if(err){throw err;}
else{tmpl.render(ctx,cb||function(err,res){if(err){throw err;}
syncResult=res;});}});return syncResult;},renderString:function(src,ctx,opts,cb){if(lib.isFunction(opts)){cb=opts;opts={};}
opts=opts||{};var tmpl=new Template(src,this,opts.path);return tmpl.render(ctx,cb);}});var Context=Obj.extend({init:function(ctx,blocks){this.ctx=ctx;this.blocks={};this.exported=[];for(var name in blocks){this.addBlock(name,blocks[name]);}},lookup:function(name){if(name in globals&&!(name in this.ctx)){return globals[name];}
else{return this.ctx[name];}},setVariable:function(name,val){this.ctx[name]=val;},getVariables:function(){return this.ctx;},addBlock:function(name,block){this.blocks[name]=this.blocks[name]||[];this.blocks[name].push(block);},getBlock:function(name){if(!this.blocks[name]){throw new Error('unknown block "'+name+'"');}
return this.blocks[name][0];},getSuper:function(env,name,block,frame,runtime,cb){var idx=lib.indexOf(this.blocks[name]||[],block);var blk=this.blocks[name][idx+1];var context=this;if(idx===-1||!blk){throw new Error('no super block available for "'+name+'"');}
blk(env,context,frame,runtime,cb);},addExport:function(name){this.exported.push(name);},getExported:function(){var exported={};for(var i=0;i<this.exported.length;i++){var name=this.exported[i];exported[name]=this.ctx[name];}
return exported;}});var Template=Obj.extend({init:function(src,env,path,eagerCompile){this.env=env||new Environment();if(lib.isObject(src)){switch(src.type){case 'code':this.tmplProps=src.obj;break;case 'string':this.tmplStr=src.obj;break;}}
else if(lib.isString(src)){this.tmplStr=src;}
else{throw new Error('src must be a string or an object describing '+
'the source');}
this.path=path;if(eagerCompile){lib.withPrettyErrors(this.path,this.env.dev,this._compile.bind(this));}
else{this.compiled=false;}},render:function(ctx,frame,cb){if(typeof ctx==='function'){cb=ctx;ctx={};}
else if(typeof frame==='function'){cb=frame;frame=null;}
return lib.withPrettyErrors(this.path,this.env.dev,function(){try{this.compile();}catch(e){if(cb)return cb(e);else throw e;}
var context=new Context(ctx||{},this.blocks);var syncResult=null;this.rootRenderFunc(this.env,context,frame||new Frame(),runtime,cb||function(err,res){if(err){throw err;}
syncResult=res;});return syncResult;}.bind(this));},getExported:function(ctx,frame,cb){if(typeof ctx==='function'){cb=ctx;ctx={};}
if(typeof frame==='function'){cb=frame;frame=null;}
try{this.compile();}catch(e){if(cb)return cb(e);else throw e;}
var context=new Context(ctx||{},this.blocks);this.rootRenderFunc(this.env,context,frame||new Frame(),runtime,function(){cb(null,context.getExported());});},compile:function(){if(!this.compiled){this._compile();}},_compile:function(){var props;if(this.tmplProps){props=this.tmplProps;}
else{var source=compiler.compile(this.tmplStr,this.env.asyncFilters,this.env.extensionsList,this.path,this.env.opts);var func=new Function(source);props=func();}
this.blocks=this._getBlocks(props);this.rootRenderFunc=props.root;this.compiled=true;},_getBlocks:function(props){var blocks={};for(var k in props){if(k.slice(0,2)==='b_'){blocks[k.slice(2)]=props[k];}}
return blocks;}});modules['environment']={Environment:Environment,Template:Template};})();var nunjucks;var lib=modules["lib"];var env=modules["environment"];var compiler=modules["compiler"];var parser=modules["parser"];var lexer=modules["lexer"];var runtime=modules["runtime"];var Loader=modules["loader"];var loaders=modules["loaders"];var precompile=modules["precompile"];nunjucks={};nunjucks.Environment=env.Environment;nunjucks.Template=env.Template;nunjucks.Loader=Loader;nunjucks.FileSystemLoader=loaders.FileSystemLoader;nunjucks.WebLoader=loaders.WebLoader;nunjucks.compiler=compiler;nunjucks.parser=parser;nunjucks.lexer=lexer;nunjucks.runtime=runtime;var e;nunjucks.configure=function(templatesPath,opts){opts=opts||{};if(lib.isObject(templatesPath)){opts=templatesPath;templatesPath=null;}
var noWatch='watch'in opts?!opts.watch:false;var loader=loaders.FileSystemLoader||loaders.WebLoader;e=new env.Environment(new loader(templatesPath,noWatch),opts);if(opts&&opts.express){e.express(opts.express);}
return e;};nunjucks.compile=function(src,env,path,eagerCompile){if(!e){nunjucks.configure();}
return new nunjucks.Template(src,env,path,eagerCompile);};nunjucks.render=function(name,ctx,cb){if(!e){nunjucks.configure();}
return e.render(name,ctx,cb);};nunjucks.renderString=function(src,ctx,cb){if(!e){nunjucks.configure();}
return e.renderString(src,ctx,cb);};if(precompile){nunjucks.precompile=precompile.precompile;nunjucks.precompileString=precompile.precompileString;}
nunjucks.require=function(name){return modules[name];};if(typeof define==='function'&&define.amd){define(function(){return nunjucks;});}
else{window.nunjucks=nunjucks;if(typeof module!=='undefined')module.exports=nunjucks;}})();},{}]},{},[1]);